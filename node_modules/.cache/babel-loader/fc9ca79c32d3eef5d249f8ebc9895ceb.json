{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nimport _isFunction from \"lodash/isFunction\";\nimport _isNil from \"lodash/isNil\";\nimport _isUndefined from \"lodash/isUndefined\";\nimport _omit from \"lodash/omit\";\nimport _pick from \"lodash/pick\";\nimport React, { useState, useRef, useEffect, useCallback, useContext, useMemo } from 'react';\nimport PropTypes from 'prop-types';\nimport { List, AutoSizer } from '../Windowing';\nimport TreeNode from './TreeNode';\nimport { createDragPreview, getKeyParentMap, getPathTowardsItem, getTreeNodeIndent, removeDragPreview, stringifyTreeNodeLabel } from '../utils/treeUtils';\nimport { createChainedFunction, useClassNames, useCustom, useControlled, TREE_NODE_DROP_POSITION, KEY_VALUES, mergeRefs, shallowEqual } from '../utils';\nimport { getExpandWhenSearching, hasVisibleChildren, getDragNodeKeys, calDropNodePosition, createUpdateTreeDataFunction, useTreeDrag, useFlattenTreeData, getTreeActiveNode, getDefaultExpandItemValues, useTreeNodeRefs, useTreeSearch, focusPreviousItem, getFocusableItems, focusNextItem, getActiveItem, toggleExpand, useGetTreeNodeChildren, focusToActiveTreeNode, leftArrowHandler, focusTreeNode, rightArrowHandler, isSearching } from '../utils/treeUtils';\nimport { PickerToggle, PickerOverlay, SearchBar, PickerToggleTrigger, createConcatChildrenFunction, usePickerClassName, onMenuKeyDown as _onMenuKeyDown, usePublicMethods, listPickerPropTypes, pickTriggerPropKeys, omitTriggerPropKeys, useToggleKeyDownEvent } from '../Picker';\nimport TreeContext from '../Tree/TreeContext';\nvar emptyArray = [];\n\nvar itemSize = function itemSize() {\n  return 36;\n};\n\nvar TreePicker = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  var _props$as = props.as,\n      Component = _props$as === void 0 ? 'div' : _props$as,\n      _props$data = props.data,\n      data = _props$data === void 0 ? emptyArray : _props$data,\n      _props$appearance = props.appearance,\n      appearance = _props$appearance === void 0 ? 'default' : _props$appearance,\n      style = props.style,\n      showIndentLine = props.showIndentLine,\n      controlledValue = props.value,\n      overrideLocale = props.locale,\n      _props$height = props.height,\n      height = _props$height === void 0 ? 360 : _props$height,\n      _props$menuMaxHeight = props.menuMaxHeight,\n      menuMaxHeight = _props$menuMaxHeight === void 0 ? 320 : _props$menuMaxHeight,\n      menuStyle = props.menuStyle,\n      className = props.className,\n      disabled = props.disabled,\n      _props$placement = props.placement,\n      placement = _props$placement === void 0 ? 'bottomStart' : _props$placement,\n      _props$cleanable = props.cleanable,\n      cleanable = _props$cleanable === void 0 ? true : _props$cleanable,\n      _props$searchable = props.searchable,\n      searchable = _props$searchable === void 0 ? true : _props$searchable,\n      _props$virtualized = props.virtualized,\n      virtualized = _props$virtualized === void 0 ? false : _props$virtualized,\n      _props$classPrefix = props.classPrefix,\n      classPrefix = _props$classPrefix === void 0 ? 'picker' : _props$classPrefix,\n      defaultValue = props.defaultValue,\n      placeholder = props.placeholder,\n      searchKeyword = props.searchKeyword,\n      menuClassName = props.menuClassName,\n      _props$menuAutoWidth = props.menuAutoWidth,\n      menuAutoWidth = _props$menuAutoWidth === void 0 ? true : _props$menuAutoWidth,\n      searchBy = props.searchBy,\n      toggleAs = props.toggleAs,\n      _props$labelKey = props.labelKey,\n      labelKey = _props$labelKey === void 0 ? 'label' : _props$labelKey,\n      _props$valueKey = props.valueKey,\n      valueKey = _props$valueKey === void 0 ? 'value' : _props$valueKey,\n      _props$childrenKey = props.childrenKey,\n      childrenKey = _props$childrenKey === void 0 ? 'children' : _props$childrenKey,\n      draggable = props.draggable,\n      _props$defaultExpandA = props.defaultExpandAll,\n      defaultExpandAll = _props$defaultExpandA === void 0 ? false : _props$defaultExpandA,\n      _props$disabledItemVa = props.disabledItemValues,\n      disabledItemValues = _props$disabledItemVa === void 0 ? emptyArray : _props$disabledItemVa,\n      controlledExpandItemValues = props.expandItemValues,\n      _props$defaultExpandI = props.defaultExpandItemValues,\n      defaultExpandItemValues = _props$defaultExpandI === void 0 ? emptyArray : _props$defaultExpandI,\n      id = props.id,\n      listProps = props.listProps,\n      getChildren = props.getChildren,\n      renderTreeIcon = props.renderTreeIcon,\n      renderTreeNode = props.renderTreeNode,\n      onExit = props.onExit,\n      onExited = props.onExited,\n      onClean = props.onClean,\n      onOpen = props.onOpen,\n      onSearch = props.onSearch,\n      onSelect = props.onSelect,\n      onSelectItem = props.onSelectItem,\n      onChange = props.onChange,\n      onEntered = props.onEntered,\n      onClose = props.onClose,\n      onDragEnd = props.onDragEnd,\n      onDragStart = props.onDragStart,\n      onDragEnter = props.onDragEnter,\n      onDragLeave = props.onDragLeave,\n      onDragOver = props.onDragOver,\n      onDrop = props.onDrop,\n      onExpand = props.onExpand,\n      renderExtraFooter = props.renderExtraFooter,\n      renderMenu = props.renderMenu,\n      renderValue = props.renderValue,\n      rest = _objectWithoutPropertiesLoose(props, [\"as\", \"data\", \"appearance\", \"style\", \"showIndentLine\", \"value\", \"locale\", \"height\", \"menuMaxHeight\", \"menuStyle\", \"className\", \"disabled\", \"placement\", \"cleanable\", \"searchable\", \"virtualized\", \"classPrefix\", \"defaultValue\", \"placeholder\", \"searchKeyword\", \"menuClassName\", \"menuAutoWidth\", \"searchBy\", \"toggleAs\", \"labelKey\", \"valueKey\", \"childrenKey\", \"draggable\", \"defaultExpandAll\", \"disabledItemValues\", \"expandItemValues\", \"defaultExpandItemValues\", \"id\", \"listProps\", \"getChildren\", \"renderTreeIcon\", \"renderTreeNode\", \"onExit\", \"onExited\", \"onClean\", \"onOpen\", \"onSearch\", \"onSelect\", \"onSelectItem\", \"onChange\", \"onEntered\", \"onClose\", \"onDragEnd\", \"onDragStart\", \"onDragEnter\", \"onDragLeave\", \"onDragOver\", \"onDrop\", \"onExpand\", \"renderExtraFooter\", \"renderMenu\", \"renderValue\"]);\n\n  var triggerRef = useRef(null);\n  var targetRef = useRef(null);\n  var listRef = useRef(null);\n  var overlayRef = useRef(null);\n  var searchInputRef = useRef(null);\n  var treeViewRef = useRef(null);\n\n  var _useCustom = useCustom('Picker', overrideLocale),\n      rtl = _useCustom.rtl,\n      locale = _useCustom.locale;\n\n  var _useContext = useContext(TreeContext),\n      inline = _useContext.inline;\n\n  var _useControlled = useControlled(controlledValue, defaultValue),\n      value = _useControlled[0],\n      setValue = _useControlled[1],\n      isControlled = _useControlled[2];\n\n  var _useGetTreeNodeChildr = useGetTreeNodeChildren(data, valueKey, childrenKey),\n      treeData = _useGetTreeNodeChildr.data,\n      setTreeData = _useGetTreeNodeChildr.setData,\n      loadingNodeValues = _useGetTreeNodeChildr.loadingNodeValues,\n      loadChildren = _useGetTreeNodeChildr.loadChildren;\n\n  var _useControlled2 = useControlled(controlledExpandItemValues, getDefaultExpandItemValues(treeData, {\n    defaultExpandAll: defaultExpandAll,\n    valueKey: valueKey,\n    childrenKey: childrenKey,\n    defaultExpandItemValues: defaultExpandItemValues\n  })),\n      expandItemValues = _useControlled2[0],\n      setExpandItemValues = _useControlled2[1];\n\n  var _useState = useState(false),\n      active = _useState[0],\n      setActive = _useState[1];\n\n  var _useState2 = useState(null),\n      focusItemValue = _useState2[0],\n      setFocusItemValue = _useState2[1];\n\n  var _useFlattenTreeData = useFlattenTreeData({\n    data: treeData,\n    labelKey: labelKey,\n    valueKey: valueKey,\n    childrenKey: childrenKey,\n    callback: function callback() {\n      // after flattenData, always trigger re-render\n      forceUpdate();\n    }\n  }),\n      flattenNodes = _useFlattenTreeData.flattenNodes,\n      forceUpdate = _useFlattenTreeData.forceUpdate,\n      formatVirtualizedTreeData = _useFlattenTreeData.formatVirtualizedTreeData;\n\n  var _useClassNames = useClassNames(classPrefix),\n      prefix = _useClassNames.prefix,\n      merge = _useClassNames.merge;\n\n  var _useClassNames2 = useClassNames('tree'),\n      treePrefix = _useClassNames2.prefix,\n      withTreeClassPrefix = _useClassNames2.withClassPrefix;\n\n  var _useTreeSearch = useTreeSearch({\n    labelKey: labelKey,\n    childrenKey: childrenKey,\n    searchKeyword: searchKeyword,\n    data: treeData,\n    searchBy: searchBy,\n    callback: function callback(searchKeyword, _filterData, event) {\n      onSearch === null || onSearch === void 0 ? void 0 : onSearch(searchKeyword, event);\n    }\n  }),\n      filteredData = _useTreeSearch.filteredData,\n      searchKeywordState = _useTreeSearch.searchKeywordState,\n      setSearchKeyword = _useTreeSearch.setSearchKeyword,\n      handleSearch = _useTreeSearch.handleSearch,\n      setFilteredData = _useTreeSearch.setFilteredData;\n\n  var _useTreeDrag = useTreeDrag(),\n      dragNodeKeys = _useTreeDrag.dragNodeKeys,\n      dragOverNodeKey = _useTreeDrag.dragOverNodeKey,\n      dragNode = _useTreeDrag.dragNode,\n      dropNodePosition = _useTreeDrag.dropNodePosition,\n      setDragNodeKeys = _useTreeDrag.setDragNodeKeys,\n      setDragOverNodeKey = _useTreeDrag.setDragOverNodeKey,\n      setDragNode = _useTreeDrag.setDragNode,\n      setDropNodePosition = _useTreeDrag.setDropNodePosition;\n\n  var _useTreeNodeRefs = useTreeNodeRefs(),\n      treeNodesRefs = _useTreeNodeRefs.treeNodesRefs,\n      saveTreeNodeRef = _useTreeNodeRefs.saveTreeNodeRef;\n\n  var activeNode = getTreeActiveNode(flattenNodes, value, valueKey);\n  var getFormattedNodes = useCallback(function (render) {\n    if (virtualized) {\n      return formatVirtualizedTreeData(flattenNodes, filteredData, expandItemValues, {\n        searchKeyword: searchKeywordState\n      }).filter(function (n) {\n        return n.visible;\n      });\n    }\n\n    return filteredData.map(function (dataItem, index) {\n      return render === null || render === void 0 ? void 0 : render(dataItem, index, 1);\n    });\n  }, [searchKeywordState, expandItemValues, filteredData, flattenNodes, formatVirtualizedTreeData, virtualized]);\n  var focusActiveNode = useCallback(function () {\n    if (listRef.current) {\n      focusToActiveTreeNode({\n        list: listRef.current,\n        valueKey: valueKey,\n        selector: \".\" + treePrefix('node-active'),\n        activeNode: activeNode,\n        virtualized: virtualized,\n        container: treeViewRef.current,\n        formattedNodes: getFormattedNodes()\n      });\n    }\n  }, [treePrefix, activeNode, getFormattedNodes, valueKey, virtualized]);\n  useEffect(function () {\n    setFilteredData(data, searchKeywordState);\n    setTreeData(data);\n  }, [data, searchKeywordState, setFilteredData, setTreeData]);\n  useEffect(function () {\n    setFilteredData(treeData, searchKeywordState);\n  }, [treeData, searchKeywordState, setFilteredData]);\n  useEffect(function () {\n    if (Array.isArray(controlledExpandItemValues)) {\n      setExpandItemValues(controlledExpandItemValues);\n    }\n  }, [controlledExpandItemValues, setExpandItemValues]);\n  useEffect(function () {\n    setSearchKeyword(searchKeyword !== null && searchKeyword !== void 0 ? searchKeyword : '');\n  }, [searchKeyword, setSearchKeyword]);\n  var getDropData = useCallback(function (nodeData) {\n    var options = {\n      valueKey: valueKey,\n      childrenKey: childrenKey\n    };\n    return {\n      /** draggingNode */\n      dragNode: dragNode,\n\n      /** dropNode */\n      dropNode: nodeData,\n\n      /** dragAndDrop Position type */\n      dropNodePosition: dropNodePosition,\n      createUpdateDataFunction: createUpdateTreeDataFunction({\n        dragNode: dragNode,\n        dropNode: nodeData,\n        dropNodePosition: dropNodePosition\n      }, options)\n    };\n  }, [dragNode, valueKey, childrenKey, dropNodePosition]);\n\n  var getTreeNodeProps = function getTreeNodeProps(node, layer, index) {\n    var draggingNode = dragNode !== null && dragNode !== void 0 ? dragNode : {};\n    return {\n      as: Component,\n      rtl: rtl,\n      value: node[valueKey],\n      label: node[labelKey],\n      index: index,\n      layer: layer,\n      loading: loadingNodeValues.some(function (item) {\n        return shallowEqual(item, node[valueKey]);\n      }),\n      expand: node.expand,\n      active: shallowEqual(node[valueKey], value),\n      focus: shallowEqual(node[valueKey], focusItemValue),\n      visible: node.visible,\n      draggable: draggable,\n      dragging: shallowEqual(node[valueKey], draggingNode[valueKey]),\n      children: node[childrenKey],\n      nodeData: node,\n      disabled: disabledItemValues.some(function (disabledItem) {\n        return shallowEqual(disabledItem, node[valueKey]);\n      }),\n      dragOver: shallowEqual(node[valueKey], dragOverNodeKey) && dropNodePosition === TREE_NODE_DROP_POSITION.DRAG_OVER,\n      dragOverTop: shallowEqual(node[valueKey], dragOverNodeKey) && dropNodePosition === TREE_NODE_DROP_POSITION.DRAG_OVER_TOP,\n      dragOverBottom: shallowEqual(node[valueKey], dragOverNodeKey) && dropNodePosition === TREE_NODE_DROP_POSITION.DRAG_OVER_BOTTOM,\n      onSelect: handleSelect,\n      onDragStart: handleDragStart,\n      onDragEnter: handleDragEnter,\n      onDragOver: handleDragOver,\n      onDragLeave: handleDragLeave,\n      onDragEnd: handleDragEnd,\n      onDrop: handleDrop,\n      onExpand: handleExpand,\n      onRenderTreeNode: renderTreeNode,\n      onRenderTreeIcon: renderTreeIcon\n    };\n  }; // TODO-Doma\n  // Replace `getKeyParentMap` with `getParentMap`\n\n\n  var itemParentMap = useMemo(function () {\n    return getKeyParentMap(data, function (node) {\n      return node[valueKey];\n    }, function (node) {\n      return node[childrenKey];\n    });\n  }, [childrenKey, data, valueKey]);\n  var handleSelect = useCallback(function (nodeData, event) {\n    var _targetRef$current, _triggerRef$current, _triggerRef$current$c;\n\n    if (!nodeData) {\n      return;\n    }\n\n    var nodeValue = nodeData[valueKey];\n\n    if (!isControlled) {\n      setValue(nodeValue);\n    }\n\n    setFocusItemValue(nodeData[valueKey]);\n    onChange === null || onChange === void 0 ? void 0 : onChange(nodeValue, event);\n    onSelect === null || onSelect === void 0 ? void 0 : onSelect(nodeData, nodeValue, event);\n    onSelectItem === null || onSelectItem === void 0 ? void 0 : onSelectItem(nodeData, getPathTowardsItem(nodeData, function (item) {\n      return itemParentMap.get(item[valueKey]);\n    }));\n    (_targetRef$current = targetRef.current) === null || _targetRef$current === void 0 ? void 0 : _targetRef$current.focus();\n    (_triggerRef$current = triggerRef.current) === null || _triggerRef$current === void 0 ? void 0 : (_triggerRef$current$c = _triggerRef$current.close) === null || _triggerRef$current$c === void 0 ? void 0 : _triggerRef$current$c.call(_triggerRef$current);\n  }, [valueKey, isControlled, onChange, onSelect, onSelectItem, setValue, itemParentMap]);\n  var handleExpand = useCallback(function (node) {\n    var nextExpandItemValues = toggleExpand({\n      node: node,\n      isExpand: !node.expand,\n      expandItemValues: expandItemValues,\n      valueKey: valueKey\n    });\n    setExpandItemValues(nextExpandItemValues);\n    onExpand === null || onExpand === void 0 ? void 0 : onExpand(nextExpandItemValues, node, createConcatChildrenFunction(node, node[valueKey], {\n      valueKey: valueKey,\n      childrenKey: childrenKey\n    }));\n\n    if (_isFunction(getChildren) && !node.expand && Array.isArray(node[childrenKey]) && node[childrenKey].length === 0) {\n      loadChildren(node, getChildren);\n    }\n  }, [valueKey, childrenKey, expandItemValues, getChildren, onExpand, setExpandItemValues, loadChildren]);\n  var handleDragStart = useCallback(function (nodeData, event) {\n    if (draggable) {\n      var _event$dataTransfer;\n\n      var dragMoverNode = createDragPreview(stringifyTreeNodeLabel(nodeData[labelKey]), treePrefix('drag-preview'));\n      (_event$dataTransfer = event.dataTransfer) === null || _event$dataTransfer === void 0 ? void 0 : _event$dataTransfer.setDragImage(dragMoverNode, 0, 0);\n      setDragNodeKeys(getDragNodeKeys(nodeData, childrenKey, valueKey));\n      setDragNode(flattenNodes[nodeData.refKey]);\n      onDragStart === null || onDragStart === void 0 ? void 0 : onDragStart(nodeData, event);\n    }\n  }, [draggable, labelKey, treePrefix, setDragNodeKeys, childrenKey, valueKey, setDragNode, flattenNodes, onDragStart]);\n  var handleDragEnter = useCallback(function (nodeData, event) {\n    if (dragNodeKeys.some(function (d) {\n      return shallowEqual(d, nodeData[valueKey]);\n    })) {\n      return;\n    }\n\n    if (dragNode) {\n      setDragOverNodeKey(nodeData[valueKey]);\n      setDropNodePosition(calDropNodePosition(event, treeNodesRefs[nodeData.refKey]));\n    }\n\n    onDragEnter === null || onDragEnter === void 0 ? void 0 : onDragEnter(nodeData, event);\n  }, [dragNode, treeNodesRefs, dragNodeKeys, onDragEnter, setDragOverNodeKey, setDropNodePosition, valueKey]);\n  var handleDragOver = useCallback(function (nodeData, event) {\n    if (dragNodeKeys.some(function (d) {\n      return shallowEqual(d, nodeData[valueKey]);\n    })) {\n      event.dataTransfer.dropEffect = 'none';\n      return;\n    }\n\n    if (dragNode && shallowEqual(nodeData[valueKey], dragOverNodeKey)) {\n      var lastDropNodePosition = calDropNodePosition(event, treeNodesRefs[nodeData.refKey]);\n      if (lastDropNodePosition === dropNodePosition) return;\n      setDropNodePosition(lastDropNodePosition);\n    }\n\n    onDragOver === null || onDragOver === void 0 ? void 0 : onDragOver(nodeData, event);\n  }, [dragNode, dragNodeKeys, dragOverNodeKey, dropNodePosition, onDragOver, setDropNodePosition, treeNodesRefs, valueKey]);\n  var handleDragLeave = useCallback(function (nodeData, event) {\n    onDragLeave === null || onDragLeave === void 0 ? void 0 : onDragLeave(nodeData, event);\n  }, [onDragLeave]);\n  var handleDragEnd = useCallback(function (nodeData, event) {\n    removeDragPreview();\n    setDragNode(null);\n    setDragNodeKeys([]);\n    setDragOverNodeKey(null);\n    onDragEnd === null || onDragEnd === void 0 ? void 0 : onDragEnd(nodeData, event);\n  }, [setDragNode, setDragNodeKeys, setDragOverNodeKey, onDragEnd]);\n  var handleDrop = useCallback(function (nodeData, event) {\n    if (dragNodeKeys.some(function (d) {\n      return shallowEqual(d, nodeData[valueKey]);\n    })) {\n      console.error('Cannot drag a node to itself and its children');\n    } else {\n      var dropData = getDropData(nodeData);\n      onDrop === null || onDrop === void 0 ? void 0 : onDrop(dropData, event);\n    }\n\n    removeDragPreview();\n    setDragNode(null);\n    setDragNodeKeys([]);\n    setDragOverNodeKey(null);\n  }, [dragNodeKeys, setDragNode, setDragOverNodeKey, setDragNodeKeys, onDrop, getDropData, valueKey]);\n  var handleOpen = useCallback(function () {\n    var _triggerRef$current2, _triggerRef$current2$;\n\n    (_triggerRef$current2 = triggerRef.current) === null || _triggerRef$current2 === void 0 ? void 0 : (_triggerRef$current2$ = _triggerRef$current2.open) === null || _triggerRef$current2$ === void 0 ? void 0 : _triggerRef$current2$.call(_triggerRef$current2);\n    focusActiveNode();\n    onOpen === null || onOpen === void 0 ? void 0 : onOpen();\n    setActive(true);\n  }, [focusActiveNode, onOpen]);\n  var handleClose = useCallback(function () {\n    var _triggerRef$current3, _triggerRef$current3$, _targetRef$current2;\n\n    (_triggerRef$current3 = triggerRef.current) === null || _triggerRef$current3 === void 0 ? void 0 : (_triggerRef$current3$ = _triggerRef$current3.close) === null || _triggerRef$current3$ === void 0 ? void 0 : _triggerRef$current3$.call(_triggerRef$current3);\n    setSearchKeyword('');\n    setActive(false);\n    setFocusItemValue(activeNode === null || activeNode === void 0 ? void 0 : activeNode[valueKey]);\n    /**\n     * when using keyboard toggle picker, should refocus on PickerToggle Component after close picker menu\n     */\n\n    (_targetRef$current2 = targetRef.current) === null || _targetRef$current2 === void 0 ? void 0 : _targetRef$current2.focus();\n  }, [activeNode, setSearchKeyword, valueKey]);\n  usePublicMethods(ref, {\n    rootRef: inline ? treeViewRef : undefined,\n    triggerRef: triggerRef,\n    overlayRef: overlayRef,\n    targetRef: targetRef,\n    listRef: listRef,\n    inline: inline\n  });\n  var handleFocusItem = useCallback(function (key) {\n    var focusableItems = getFocusableItems(filteredData, {\n      disabledItemValues: disabledItemValues,\n      valueKey: valueKey,\n      childrenKey: childrenKey,\n      expandItemValues: expandItemValues\n    }, isSearching(searchKeywordState));\n    var selector = \".\" + treePrefix('node-label');\n    var focusProps = {\n      focusItemValue: focusItemValue,\n      focusableItems: focusableItems,\n      treeNodesRefs: treeNodesRefs,\n      selector: selector,\n      valueKey: valueKey,\n      callback: function callback(nextFocusItemValue) {\n        setFocusItemValue(nextFocusItemValue);\n      }\n    };\n\n    if (key === KEY_VALUES.DOWN) {\n      focusNextItem(focusProps);\n      return;\n    }\n\n    if (key === KEY_VALUES.UP) {\n      focusPreviousItem(focusProps);\n    }\n  }, [searchKeywordState, expandItemValues, filteredData, focusItemValue, treeNodesRefs, treePrefix, valueKey, childrenKey, disabledItemValues]);\n  var handleLeftArrow = useCallback(function () {\n    if (_isNil(focusItemValue)) return;\n    var focusItem = getActiveItem(focusItemValue, flattenNodes, valueKey);\n    leftArrowHandler({\n      focusItem: focusItem,\n      expand: expandItemValues.includes(focusItem === null || focusItem === void 0 ? void 0 : focusItem[valueKey]),\n      onExpand: handleExpand,\n      childrenKey: childrenKey,\n      onFocusItem: function onFocusItem() {\n        var _focusItem$parent, _focusItem$parent2;\n\n        setFocusItemValue(focusItem === null || focusItem === void 0 ? void 0 : (_focusItem$parent = focusItem.parent) === null || _focusItem$parent === void 0 ? void 0 : _focusItem$parent[valueKey]);\n        focusTreeNode(focusItem === null || focusItem === void 0 ? void 0 : (_focusItem$parent2 = focusItem.parent) === null || _focusItem$parent2 === void 0 ? void 0 : _focusItem$parent2.refKey, treeNodesRefs, \".\" + treePrefix('node-label'));\n      }\n    });\n  }, [expandItemValues, flattenNodes, focusItemValue, handleExpand, treeNodesRefs, treePrefix, valueKey, childrenKey]);\n  var handleRightArrow = useCallback(function () {\n    if (_isNil(focusItemValue)) return;\n    var focusItem = getActiveItem(focusItemValue, flattenNodes, valueKey);\n    rightArrowHandler({\n      focusItem: focusItem,\n      expand: expandItemValues.includes(focusItem === null || focusItem === void 0 ? void 0 : focusItem[valueKey]),\n      childrenKey: childrenKey,\n      onExpand: handleExpand,\n      onFocusItem: function onFocusItem() {\n        handleFocusItem(KEY_VALUES.DOWN);\n      }\n    });\n  }, [focusItemValue, flattenNodes, valueKey, expandItemValues, childrenKey, handleExpand, handleFocusItem]);\n  var selectActiveItem = useCallback(function (event) {\n    if (_isNil(focusItemValue)) return;\n    var activeItem = getActiveItem(focusItemValue, flattenNodes, valueKey);\n    handleSelect(activeItem, event);\n  }, [flattenNodes, valueKey, focusItemValue, handleSelect]);\n  var handleClean = useCallback(function (event) {\n    var nullValue = null;\n    var target = event.target; // exclude searchBar\n\n    if (target.matches('div[role=\"searchbox\"] > input') || disabled || !cleanable) {\n      return;\n    }\n\n    if (!isControlled) {\n      setValue(null);\n    }\n\n    onChange === null || onChange === void 0 ? void 0 : onChange(nullValue, event);\n  }, [cleanable, disabled, onChange, setValue, isControlled]);\n  var onPickerKeydown = useToggleKeyDownEvent(_extends({\n    toggle: !activeNode || !active,\n    triggerRef: triggerRef,\n    targetRef: targetRef,\n    overlayRef: overlayRef,\n    searchInputRef: searchInputRef,\n    active: active,\n    onExit: handleClean,\n    onClose: handleClose,\n    onMenuKeyDown: function onMenuKeyDown(event) {\n      _onMenuKeyDown(event, {\n        down: function down() {\n          return handleFocusItem(KEY_VALUES.DOWN);\n        },\n        up: function up() {\n          return handleFocusItem(KEY_VALUES.UP);\n        },\n        left: rtl ? handleRightArrow : handleLeftArrow,\n        right: rtl ? handleLeftArrow : handleRightArrow,\n        enter: selectActiveItem,\n        del: handleClean\n      });\n    }\n  }, rest));\n  var handleTreeKeyDown = useCallback(function (event) {\n    if (!treeViewRef.current) {\n      return;\n    }\n\n    _onMenuKeyDown(event, {\n      down: function down() {\n        return handleFocusItem(KEY_VALUES.DOWN);\n      },\n      up: function up() {\n        return handleFocusItem(KEY_VALUES.UP);\n      },\n      left: rtl ? handleRightArrow : handleLeftArrow,\n      right: rtl ? handleLeftArrow : handleRightArrow,\n      enter: selectActiveItem\n    });\n  }, [handleFocusItem, handleLeftArrow, handleRightArrow, rtl, selectActiveItem]);\n\n  var renderNode = function renderNode(node, index, layer) {\n    if (!node.visible) {\n      return null;\n    }\n\n    var children = node[childrenKey];\n    var expand = getExpandWhenSearching(searchKeywordState, expandItemValues.includes(node[valueKey]));\n    var visibleChildren = _isUndefined(searchKeywordState) || searchKeywordState.length === 0 ? !!children : hasVisibleChildren(node, childrenKey);\n\n    var nodeProps = _extends({}, getTreeNodeProps(_extends({}, node, {\n      expand: expand\n    }), layer, index), {\n      hasChildren: visibleChildren\n    });\n\n    if (nodeProps.hasChildren) {\n      var _merge;\n\n      layer += 1;\n      var openClass = treePrefix('open');\n      var childrenClass = merge(treePrefix('node-children'), (_merge = {}, _merge[openClass] = expand && visibleChildren, _merge));\n      var nodes = children || [];\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: childrenClass,\n        key: node[valueKey]\n      }, /*#__PURE__*/React.createElement(TreeNode, _extends({}, nodeProps, {\n        ref: function ref(_ref) {\n          return saveTreeNodeRef(_ref, node.refKey);\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: treePrefix('children')\n      }, nodes.map(function (child, i) {\n        return renderNode(child, i, layer);\n      }), showIndentLine && /*#__PURE__*/React.createElement(\"span\", {\n        className: treePrefix('indent-line'),\n        style: getTreeNodeIndent(rtl, layer - 1, true)\n      })));\n    }\n\n    return /*#__PURE__*/React.createElement(TreeNode, _extends({\n      ref: function ref(_ref2) {\n        return saveTreeNodeRef(_ref2, node.refKey);\n      },\n      key: node[valueKey]\n    }, nodeProps));\n  };\n\n  var renderVirtualListNode = function renderVirtualListNode(_ref3) {\n    var index = _ref3.index,\n        style = _ref3.style,\n        data = _ref3.data;\n    var node = data[index];\n    var layer = node.layer,\n        visible = node.visible;\n    var expand = getExpandWhenSearching(searchKeywordState, expandItemValues.includes(node[valueKey]));\n\n    if (!node.visible) {\n      return null;\n    }\n\n    var nodeProps = _extends({}, getTreeNodeProps(_extends({}, node, {\n      expand: expand\n    }), layer), {\n      style: style,\n      hasChildren: node.hasChildren\n    });\n\n    return visible && /*#__PURE__*/React.createElement(TreeNode, _extends({\n      ref: function ref(_ref4) {\n        return saveTreeNodeRef(_ref4, node.refKey);\n      }\n    }, nodeProps));\n  };\n\n  var renderTree = function renderTree() {\n    var _withTreeClassPrefix;\n\n    var classes = withTreeClassPrefix((_withTreeClassPrefix = {}, _withTreeClassPrefix[className !== null && className !== void 0 ? className : ''] = inline, _withTreeClassPrefix.virtualized = virtualized, _withTreeClassPrefix));\n    var formattedNodes = getFormattedNodes(renderNode);\n    var styles = inline ? _extends({\n      height: height\n    }, style) : {};\n    return /*#__PURE__*/React.createElement(\"div\", {\n      role: \"tree\",\n      id: id ? id + \"-listbox\" : undefined,\n      ref: treeViewRef,\n      className: classes,\n      style: styles,\n      onKeyDown: inline ? handleTreeKeyDown : undefined\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: treePrefix('nodes')\n    }, virtualized ? /*#__PURE__*/React.createElement(AutoSizer, {\n      defaultHeight: inline ? height : menuMaxHeight,\n      style: {\n        width: 'auto',\n        height: 'auto'\n      }\n    }, function (_ref5) {\n      var height = _ref5.height;\n      return /*#__PURE__*/React.createElement(List, _extends({\n        ref: listRef,\n        height: height,\n        itemSize: itemSize,\n        itemCount: formattedNodes.length,\n        itemData: formattedNodes\n      }, listProps), renderVirtualListNode);\n    }) : formattedNodes));\n  };\n\n  var renderDropdownMenu = function renderDropdownMenu(positionProps, speakerRef) {\n    var left = positionProps.left,\n        top = positionProps.top,\n        className = positionProps.className;\n    var classes = merge(className, menuClassName, prefix('tree-menu'));\n\n    var mergedMenuStyle = _extends({}, menuStyle, {\n      left: left,\n      top: top\n    });\n\n    return /*#__PURE__*/React.createElement(PickerOverlay, {\n      autoWidth: menuAutoWidth,\n      className: classes,\n      style: mergedMenuStyle,\n      ref: mergeRefs(overlayRef, speakerRef),\n      onKeyDown: onPickerKeydown,\n      target: triggerRef\n    }, searchable ? /*#__PURE__*/React.createElement(SearchBar, {\n      placeholder: locale.searchPlaceholder,\n      onChange: handleSearch,\n      value: searchKeywordState,\n      inputRef: searchInputRef\n    }) : null, renderMenu ? renderMenu(renderTree()) : renderTree(), renderExtraFooter === null || renderExtraFooter === void 0 ? void 0 : renderExtraFooter());\n  };\n  /**\n   * 1.Have a value and the value is valid.\n   * 2.Regardless of whether the value is valid, as long as renderValue is set, it is judged to have a value.\n   */\n\n\n  var hasValidValue = !_isNil(activeNode) || !_isNil(value) && _isFunction(renderValue);\n\n  var selectedElement = placeholder;\n\n  if (hasValidValue) {\n    var node = activeNode !== null && activeNode !== void 0 ? activeNode : {};\n    selectedElement = node[labelKey];\n\n    if (_isFunction(renderValue) && value) {\n      selectedElement = renderValue(value, node, selectedElement);\n\n      if (_isNil(selectedElement)) {\n        hasValidValue = false;\n      }\n    }\n  }\n\n  var _usePickerClassName = usePickerClassName(_extends({}, props, {\n    classPrefix: classPrefix,\n    appearance: appearance,\n    hasValue: hasValidValue,\n    name: 'tree',\n    cleanable: cleanable\n  })),\n      classes = _usePickerClassName[0],\n      usedClassNamePropKeys = _usePickerClassName[1];\n\n  if (inline) {\n    return renderTree();\n  }\n\n  return /*#__PURE__*/React.createElement(PickerToggleTrigger, {\n    pickerProps: _pick(props, pickTriggerPropKeys),\n    ref: triggerRef,\n    placement: placement,\n    onEnter: handleOpen,\n    onEntered: onEntered,\n    onExit: createChainedFunction(onClose, onExit),\n    onExited: createChainedFunction(handleClose, onExited),\n    speaker: renderDropdownMenu\n  }, /*#__PURE__*/React.createElement(Component, {\n    className: classes,\n    style: style\n  }, /*#__PURE__*/React.createElement(PickerToggle, _extends({}, _omit(rest, [].concat(omitTriggerPropKeys, usedClassNamePropKeys, ['cascade'])), {\n    id: id,\n    ref: targetRef,\n    appearance: appearance,\n    onKeyDown: onPickerKeydown,\n    onClean: createChainedFunction(handleClean, onClean),\n    cleanable: cleanable && !disabled,\n    as: toggleAs,\n    disabled: disabled,\n    hasValue: hasValidValue,\n    active: active,\n    placement: placement,\n    inputValue: value\n  }), selectedElement || locale.placeholder)));\n});\nTreePicker.displayName = 'TreePicker';\nTreePicker.propTypes = _extends({}, listPickerPropTypes, {\n  locale: PropTypes.any,\n  appearance: PropTypes.oneOf(['default', 'subtle']),\n  height: PropTypes.number,\n  draggable: PropTypes.bool,\n  virtualized: PropTypes.bool,\n  searchable: PropTypes.bool,\n  menuAutoWidth: PropTypes.bool,\n  searchKeyword: PropTypes.string,\n  defaultExpandAll: PropTypes.bool,\n  expandItemValues: PropTypes.array,\n  defaultExpandItemValues: PropTypes.array,\n  onSearch: PropTypes.func,\n  onExpand: PropTypes.func,\n  onSelect: PropTypes.func,\n  renderMenu: PropTypes.func,\n  renderTreeNode: PropTypes.func,\n  renderTreeIcon: PropTypes.func,\n  renderExtraFooter: PropTypes.func,\n  renderDragNode: PropTypes.func,\n  searchBy: PropTypes.func\n});\nexport default TreePicker;","map":{"version":3,"sources":["/Users/danilnagovicyn/Desktop/reactprojects/Incubator/Samurai_way/samurai-way/node_modules/rsuite/esm/TreePicker/TreePicker.js"],"names":["_extends","_objectWithoutPropertiesLoose","_isFunction","_isNil","_isUndefined","_omit","_pick","React","useState","useRef","useEffect","useCallback","useContext","useMemo","PropTypes","List","AutoSizer","TreeNode","createDragPreview","getKeyParentMap","getPathTowardsItem","getTreeNodeIndent","removeDragPreview","stringifyTreeNodeLabel","createChainedFunction","useClassNames","useCustom","useControlled","TREE_NODE_DROP_POSITION","KEY_VALUES","mergeRefs","shallowEqual","getExpandWhenSearching","hasVisibleChildren","getDragNodeKeys","calDropNodePosition","createUpdateTreeDataFunction","useTreeDrag","useFlattenTreeData","getTreeActiveNode","getDefaultExpandItemValues","useTreeNodeRefs","useTreeSearch","focusPreviousItem","getFocusableItems","focusNextItem","getActiveItem","toggleExpand","useGetTreeNodeChildren","focusToActiveTreeNode","leftArrowHandler","focusTreeNode","rightArrowHandler","isSearching","PickerToggle","PickerOverlay","SearchBar","PickerToggleTrigger","createConcatChildrenFunction","usePickerClassName","onMenuKeyDown","_onMenuKeyDown","usePublicMethods","listPickerPropTypes","pickTriggerPropKeys","omitTriggerPropKeys","useToggleKeyDownEvent","TreeContext","emptyArray","itemSize","TreePicker","forwardRef","props","ref","_props$as","as","Component","_props$data","data","_props$appearance","appearance","style","showIndentLine","controlledValue","value","overrideLocale","locale","_props$height","height","_props$menuMaxHeight","menuMaxHeight","menuStyle","className","disabled","_props$placement","placement","_props$cleanable","cleanable","_props$searchable","searchable","_props$virtualized","virtualized","_props$classPrefix","classPrefix","defaultValue","placeholder","searchKeyword","menuClassName","_props$menuAutoWidth","menuAutoWidth","searchBy","toggleAs","_props$labelKey","labelKey","_props$valueKey","valueKey","_props$childrenKey","childrenKey","draggable","_props$defaultExpandA","defaultExpandAll","_props$disabledItemVa","disabledItemValues","controlledExpandItemValues","expandItemValues","_props$defaultExpandI","defaultExpandItemValues","id","listProps","getChildren","renderTreeIcon","renderTreeNode","onExit","onExited","onClean","onOpen","onSearch","onSelect","onSelectItem","onChange","onEntered","onClose","onDragEnd","onDragStart","onDragEnter","onDragLeave","onDragOver","onDrop","onExpand","renderExtraFooter","renderMenu","renderValue","rest","triggerRef","targetRef","listRef","overlayRef","searchInputRef","treeViewRef","_useCustom","rtl","_useContext","inline","_useControlled","setValue","isControlled","_useGetTreeNodeChildr","treeData","setTreeData","setData","loadingNodeValues","loadChildren","_useControlled2","setExpandItemValues","_useState","active","setActive","_useState2","focusItemValue","setFocusItemValue","_useFlattenTreeData","callback","forceUpdate","flattenNodes","formatVirtualizedTreeData","_useClassNames","prefix","merge","_useClassNames2","treePrefix","withTreeClassPrefix","withClassPrefix","_useTreeSearch","_filterData","event","filteredData","searchKeywordState","setSearchKeyword","handleSearch","setFilteredData","_useTreeDrag","dragNodeKeys","dragOverNodeKey","dragNode","dropNodePosition","setDragNodeKeys","setDragOverNodeKey","setDragNode","setDropNodePosition","_useTreeNodeRefs","treeNodesRefs","saveTreeNodeRef","activeNode","getFormattedNodes","render","filter","n","visible","map","dataItem","index","focusActiveNode","current","list","selector","container","formattedNodes","Array","isArray","getDropData","nodeData","options","dropNode","createUpdateDataFunction","getTreeNodeProps","node","layer","draggingNode","label","loading","some","item","expand","focus","dragging","children","disabledItem","dragOver","DRAG_OVER","dragOverTop","DRAG_OVER_TOP","dragOverBottom","DRAG_OVER_BOTTOM","handleSelect","handleDragStart","handleDragEnter","handleDragOver","handleDragLeave","handleDragEnd","handleDrop","handleExpand","onRenderTreeNode","onRenderTreeIcon","itemParentMap","_targetRef$current","_triggerRef$current","_triggerRef$current$c","nodeValue","get","close","call","nextExpandItemValues","isExpand","length","_event$dataTransfer","dragMoverNode","dataTransfer","setDragImage","refKey","d","dropEffect","lastDropNodePosition","console","error","dropData","handleOpen","_triggerRef$current2","_triggerRef$current2$","open","handleClose","_triggerRef$current3","_triggerRef$current3$","_targetRef$current2","rootRef","undefined","handleFocusItem","key","focusableItems","focusProps","nextFocusItemValue","DOWN","UP","handleLeftArrow","focusItem","includes","onFocusItem","_focusItem$parent","_focusItem$parent2","parent","handleRightArrow","selectActiveItem","activeItem","handleClean","nullValue","target","matches","onPickerKeydown","toggle","down","up","left","right","enter","del","handleTreeKeyDown","renderNode","visibleChildren","nodeProps","hasChildren","_merge","openClass","childrenClass","nodes","createElement","_ref","child","i","_ref2","renderVirtualListNode","_ref3","_ref4","renderTree","_withTreeClassPrefix","classes","styles","role","onKeyDown","defaultHeight","width","_ref5","itemCount","itemData","renderDropdownMenu","positionProps","speakerRef","top","mergedMenuStyle","autoWidth","searchPlaceholder","inputRef","hasValidValue","selectedElement","_usePickerClassName","hasValue","name","usedClassNamePropKeys","pickerProps","onEnter","speaker","concat","inputValue","displayName","propTypes","any","oneOf","number","bool","string","array","func","renderDragNode"],"mappings":"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","sourcesContent":["import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nimport _isFunction from \"lodash/isFunction\";\nimport _isNil from \"lodash/isNil\";\nimport _isUndefined from \"lodash/isUndefined\";\nimport _omit from \"lodash/omit\";\nimport _pick from \"lodash/pick\";\nimport React, { useState, useRef, useEffect, useCallback, useContext, useMemo } from 'react';\nimport PropTypes from 'prop-types';\nimport { List, AutoSizer } from '../Windowing';\nimport TreeNode from './TreeNode';\nimport { createDragPreview, getKeyParentMap, getPathTowardsItem, getTreeNodeIndent, removeDragPreview, stringifyTreeNodeLabel } from '../utils/treeUtils';\nimport { createChainedFunction, useClassNames, useCustom, useControlled, TREE_NODE_DROP_POSITION, KEY_VALUES, mergeRefs, shallowEqual } from '../utils';\nimport { getExpandWhenSearching, hasVisibleChildren, getDragNodeKeys, calDropNodePosition, createUpdateTreeDataFunction, useTreeDrag, useFlattenTreeData, getTreeActiveNode, getDefaultExpandItemValues, useTreeNodeRefs, useTreeSearch, focusPreviousItem, getFocusableItems, focusNextItem, getActiveItem, toggleExpand, useGetTreeNodeChildren, focusToActiveTreeNode, leftArrowHandler, focusTreeNode, rightArrowHandler, isSearching } from '../utils/treeUtils';\nimport { PickerToggle, PickerOverlay, SearchBar, PickerToggleTrigger, createConcatChildrenFunction, usePickerClassName, onMenuKeyDown as _onMenuKeyDown, usePublicMethods, listPickerPropTypes, pickTriggerPropKeys, omitTriggerPropKeys, useToggleKeyDownEvent } from '../Picker';\nimport TreeContext from '../Tree/TreeContext';\nvar emptyArray = [];\n\nvar itemSize = function itemSize() {\n  return 36;\n};\n\nvar TreePicker = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  var _props$as = props.as,\n      Component = _props$as === void 0 ? 'div' : _props$as,\n      _props$data = props.data,\n      data = _props$data === void 0 ? emptyArray : _props$data,\n      _props$appearance = props.appearance,\n      appearance = _props$appearance === void 0 ? 'default' : _props$appearance,\n      style = props.style,\n      showIndentLine = props.showIndentLine,\n      controlledValue = props.value,\n      overrideLocale = props.locale,\n      _props$height = props.height,\n      height = _props$height === void 0 ? 360 : _props$height,\n      _props$menuMaxHeight = props.menuMaxHeight,\n      menuMaxHeight = _props$menuMaxHeight === void 0 ? 320 : _props$menuMaxHeight,\n      menuStyle = props.menuStyle,\n      className = props.className,\n      disabled = props.disabled,\n      _props$placement = props.placement,\n      placement = _props$placement === void 0 ? 'bottomStart' : _props$placement,\n      _props$cleanable = props.cleanable,\n      cleanable = _props$cleanable === void 0 ? true : _props$cleanable,\n      _props$searchable = props.searchable,\n      searchable = _props$searchable === void 0 ? true : _props$searchable,\n      _props$virtualized = props.virtualized,\n      virtualized = _props$virtualized === void 0 ? false : _props$virtualized,\n      _props$classPrefix = props.classPrefix,\n      classPrefix = _props$classPrefix === void 0 ? 'picker' : _props$classPrefix,\n      defaultValue = props.defaultValue,\n      placeholder = props.placeholder,\n      searchKeyword = props.searchKeyword,\n      menuClassName = props.menuClassName,\n      _props$menuAutoWidth = props.menuAutoWidth,\n      menuAutoWidth = _props$menuAutoWidth === void 0 ? true : _props$menuAutoWidth,\n      searchBy = props.searchBy,\n      toggleAs = props.toggleAs,\n      _props$labelKey = props.labelKey,\n      labelKey = _props$labelKey === void 0 ? 'label' : _props$labelKey,\n      _props$valueKey = props.valueKey,\n      valueKey = _props$valueKey === void 0 ? 'value' : _props$valueKey,\n      _props$childrenKey = props.childrenKey,\n      childrenKey = _props$childrenKey === void 0 ? 'children' : _props$childrenKey,\n      draggable = props.draggable,\n      _props$defaultExpandA = props.defaultExpandAll,\n      defaultExpandAll = _props$defaultExpandA === void 0 ? false : _props$defaultExpandA,\n      _props$disabledItemVa = props.disabledItemValues,\n      disabledItemValues = _props$disabledItemVa === void 0 ? emptyArray : _props$disabledItemVa,\n      controlledExpandItemValues = props.expandItemValues,\n      _props$defaultExpandI = props.defaultExpandItemValues,\n      defaultExpandItemValues = _props$defaultExpandI === void 0 ? emptyArray : _props$defaultExpandI,\n      id = props.id,\n      listProps = props.listProps,\n      getChildren = props.getChildren,\n      renderTreeIcon = props.renderTreeIcon,\n      renderTreeNode = props.renderTreeNode,\n      onExit = props.onExit,\n      onExited = props.onExited,\n      onClean = props.onClean,\n      onOpen = props.onOpen,\n      onSearch = props.onSearch,\n      onSelect = props.onSelect,\n      onSelectItem = props.onSelectItem,\n      onChange = props.onChange,\n      onEntered = props.onEntered,\n      onClose = props.onClose,\n      onDragEnd = props.onDragEnd,\n      onDragStart = props.onDragStart,\n      onDragEnter = props.onDragEnter,\n      onDragLeave = props.onDragLeave,\n      onDragOver = props.onDragOver,\n      onDrop = props.onDrop,\n      onExpand = props.onExpand,\n      renderExtraFooter = props.renderExtraFooter,\n      renderMenu = props.renderMenu,\n      renderValue = props.renderValue,\n      rest = _objectWithoutPropertiesLoose(props, [\"as\", \"data\", \"appearance\", \"style\", \"showIndentLine\", \"value\", \"locale\", \"height\", \"menuMaxHeight\", \"menuStyle\", \"className\", \"disabled\", \"placement\", \"cleanable\", \"searchable\", \"virtualized\", \"classPrefix\", \"defaultValue\", \"placeholder\", \"searchKeyword\", \"menuClassName\", \"menuAutoWidth\", \"searchBy\", \"toggleAs\", \"labelKey\", \"valueKey\", \"childrenKey\", \"draggable\", \"defaultExpandAll\", \"disabledItemValues\", \"expandItemValues\", \"defaultExpandItemValues\", \"id\", \"listProps\", \"getChildren\", \"renderTreeIcon\", \"renderTreeNode\", \"onExit\", \"onExited\", \"onClean\", \"onOpen\", \"onSearch\", \"onSelect\", \"onSelectItem\", \"onChange\", \"onEntered\", \"onClose\", \"onDragEnd\", \"onDragStart\", \"onDragEnter\", \"onDragLeave\", \"onDragOver\", \"onDrop\", \"onExpand\", \"renderExtraFooter\", \"renderMenu\", \"renderValue\"]);\n\n  var triggerRef = useRef(null);\n  var targetRef = useRef(null);\n  var listRef = useRef(null);\n  var overlayRef = useRef(null);\n  var searchInputRef = useRef(null);\n  var treeViewRef = useRef(null);\n\n  var _useCustom = useCustom('Picker', overrideLocale),\n      rtl = _useCustom.rtl,\n      locale = _useCustom.locale;\n\n  var _useContext = useContext(TreeContext),\n      inline = _useContext.inline;\n\n  var _useControlled = useControlled(controlledValue, defaultValue),\n      value = _useControlled[0],\n      setValue = _useControlled[1],\n      isControlled = _useControlled[2];\n\n  var _useGetTreeNodeChildr = useGetTreeNodeChildren(data, valueKey, childrenKey),\n      treeData = _useGetTreeNodeChildr.data,\n      setTreeData = _useGetTreeNodeChildr.setData,\n      loadingNodeValues = _useGetTreeNodeChildr.loadingNodeValues,\n      loadChildren = _useGetTreeNodeChildr.loadChildren;\n\n  var _useControlled2 = useControlled(controlledExpandItemValues, getDefaultExpandItemValues(treeData, {\n    defaultExpandAll: defaultExpandAll,\n    valueKey: valueKey,\n    childrenKey: childrenKey,\n    defaultExpandItemValues: defaultExpandItemValues\n  })),\n      expandItemValues = _useControlled2[0],\n      setExpandItemValues = _useControlled2[1];\n\n  var _useState = useState(false),\n      active = _useState[0],\n      setActive = _useState[1];\n\n  var _useState2 = useState(null),\n      focusItemValue = _useState2[0],\n      setFocusItemValue = _useState2[1];\n\n  var _useFlattenTreeData = useFlattenTreeData({\n    data: treeData,\n    labelKey: labelKey,\n    valueKey: valueKey,\n    childrenKey: childrenKey,\n    callback: function callback() {\n      // after flattenData, always trigger re-render\n      forceUpdate();\n    }\n  }),\n      flattenNodes = _useFlattenTreeData.flattenNodes,\n      forceUpdate = _useFlattenTreeData.forceUpdate,\n      formatVirtualizedTreeData = _useFlattenTreeData.formatVirtualizedTreeData;\n\n  var _useClassNames = useClassNames(classPrefix),\n      prefix = _useClassNames.prefix,\n      merge = _useClassNames.merge;\n\n  var _useClassNames2 = useClassNames('tree'),\n      treePrefix = _useClassNames2.prefix,\n      withTreeClassPrefix = _useClassNames2.withClassPrefix;\n\n  var _useTreeSearch = useTreeSearch({\n    labelKey: labelKey,\n    childrenKey: childrenKey,\n    searchKeyword: searchKeyword,\n    data: treeData,\n    searchBy: searchBy,\n    callback: function callback(searchKeyword, _filterData, event) {\n      onSearch === null || onSearch === void 0 ? void 0 : onSearch(searchKeyword, event);\n    }\n  }),\n      filteredData = _useTreeSearch.filteredData,\n      searchKeywordState = _useTreeSearch.searchKeywordState,\n      setSearchKeyword = _useTreeSearch.setSearchKeyword,\n      handleSearch = _useTreeSearch.handleSearch,\n      setFilteredData = _useTreeSearch.setFilteredData;\n\n  var _useTreeDrag = useTreeDrag(),\n      dragNodeKeys = _useTreeDrag.dragNodeKeys,\n      dragOverNodeKey = _useTreeDrag.dragOverNodeKey,\n      dragNode = _useTreeDrag.dragNode,\n      dropNodePosition = _useTreeDrag.dropNodePosition,\n      setDragNodeKeys = _useTreeDrag.setDragNodeKeys,\n      setDragOverNodeKey = _useTreeDrag.setDragOverNodeKey,\n      setDragNode = _useTreeDrag.setDragNode,\n      setDropNodePosition = _useTreeDrag.setDropNodePosition;\n\n  var _useTreeNodeRefs = useTreeNodeRefs(),\n      treeNodesRefs = _useTreeNodeRefs.treeNodesRefs,\n      saveTreeNodeRef = _useTreeNodeRefs.saveTreeNodeRef;\n\n  var activeNode = getTreeActiveNode(flattenNodes, value, valueKey);\n  var getFormattedNodes = useCallback(function (render) {\n    if (virtualized) {\n      return formatVirtualizedTreeData(flattenNodes, filteredData, expandItemValues, {\n        searchKeyword: searchKeywordState\n      }).filter(function (n) {\n        return n.visible;\n      });\n    }\n\n    return filteredData.map(function (dataItem, index) {\n      return render === null || render === void 0 ? void 0 : render(dataItem, index, 1);\n    });\n  }, [searchKeywordState, expandItemValues, filteredData, flattenNodes, formatVirtualizedTreeData, virtualized]);\n  var focusActiveNode = useCallback(function () {\n    if (listRef.current) {\n      focusToActiveTreeNode({\n        list: listRef.current,\n        valueKey: valueKey,\n        selector: \".\" + treePrefix('node-active'),\n        activeNode: activeNode,\n        virtualized: virtualized,\n        container: treeViewRef.current,\n        formattedNodes: getFormattedNodes()\n      });\n    }\n  }, [treePrefix, activeNode, getFormattedNodes, valueKey, virtualized]);\n  useEffect(function () {\n    setFilteredData(data, searchKeywordState);\n    setTreeData(data);\n  }, [data, searchKeywordState, setFilteredData, setTreeData]);\n  useEffect(function () {\n    setFilteredData(treeData, searchKeywordState);\n  }, [treeData, searchKeywordState, setFilteredData]);\n  useEffect(function () {\n    if (Array.isArray(controlledExpandItemValues)) {\n      setExpandItemValues(controlledExpandItemValues);\n    }\n  }, [controlledExpandItemValues, setExpandItemValues]);\n  useEffect(function () {\n    setSearchKeyword(searchKeyword !== null && searchKeyword !== void 0 ? searchKeyword : '');\n  }, [searchKeyword, setSearchKeyword]);\n  var getDropData = useCallback(function (nodeData) {\n    var options = {\n      valueKey: valueKey,\n      childrenKey: childrenKey\n    };\n    return {\n      /** draggingNode */\n      dragNode: dragNode,\n\n      /** dropNode */\n      dropNode: nodeData,\n\n      /** dragAndDrop Position type */\n      dropNodePosition: dropNodePosition,\n      createUpdateDataFunction: createUpdateTreeDataFunction({\n        dragNode: dragNode,\n        dropNode: nodeData,\n        dropNodePosition: dropNodePosition\n      }, options)\n    };\n  }, [dragNode, valueKey, childrenKey, dropNodePosition]);\n\n  var getTreeNodeProps = function getTreeNodeProps(node, layer, index) {\n    var draggingNode = dragNode !== null && dragNode !== void 0 ? dragNode : {};\n    return {\n      as: Component,\n      rtl: rtl,\n      value: node[valueKey],\n      label: node[labelKey],\n      index: index,\n      layer: layer,\n      loading: loadingNodeValues.some(function (item) {\n        return shallowEqual(item, node[valueKey]);\n      }),\n      expand: node.expand,\n      active: shallowEqual(node[valueKey], value),\n      focus: shallowEqual(node[valueKey], focusItemValue),\n      visible: node.visible,\n      draggable: draggable,\n      dragging: shallowEqual(node[valueKey], draggingNode[valueKey]),\n      children: node[childrenKey],\n      nodeData: node,\n      disabled: disabledItemValues.some(function (disabledItem) {\n        return shallowEqual(disabledItem, node[valueKey]);\n      }),\n      dragOver: shallowEqual(node[valueKey], dragOverNodeKey) && dropNodePosition === TREE_NODE_DROP_POSITION.DRAG_OVER,\n      dragOverTop: shallowEqual(node[valueKey], dragOverNodeKey) && dropNodePosition === TREE_NODE_DROP_POSITION.DRAG_OVER_TOP,\n      dragOverBottom: shallowEqual(node[valueKey], dragOverNodeKey) && dropNodePosition === TREE_NODE_DROP_POSITION.DRAG_OVER_BOTTOM,\n      onSelect: handleSelect,\n      onDragStart: handleDragStart,\n      onDragEnter: handleDragEnter,\n      onDragOver: handleDragOver,\n      onDragLeave: handleDragLeave,\n      onDragEnd: handleDragEnd,\n      onDrop: handleDrop,\n      onExpand: handleExpand,\n      onRenderTreeNode: renderTreeNode,\n      onRenderTreeIcon: renderTreeIcon\n    };\n  }; // TODO-Doma\n  // Replace `getKeyParentMap` with `getParentMap`\n\n\n  var itemParentMap = useMemo(function () {\n    return getKeyParentMap(data, function (node) {\n      return node[valueKey];\n    }, function (node) {\n      return node[childrenKey];\n    });\n  }, [childrenKey, data, valueKey]);\n  var handleSelect = useCallback(function (nodeData, event) {\n    var _targetRef$current, _triggerRef$current, _triggerRef$current$c;\n\n    if (!nodeData) {\n      return;\n    }\n\n    var nodeValue = nodeData[valueKey];\n\n    if (!isControlled) {\n      setValue(nodeValue);\n    }\n\n    setFocusItemValue(nodeData[valueKey]);\n    onChange === null || onChange === void 0 ? void 0 : onChange(nodeValue, event);\n    onSelect === null || onSelect === void 0 ? void 0 : onSelect(nodeData, nodeValue, event);\n    onSelectItem === null || onSelectItem === void 0 ? void 0 : onSelectItem(nodeData, getPathTowardsItem(nodeData, function (item) {\n      return itemParentMap.get(item[valueKey]);\n    }));\n    (_targetRef$current = targetRef.current) === null || _targetRef$current === void 0 ? void 0 : _targetRef$current.focus();\n    (_triggerRef$current = triggerRef.current) === null || _triggerRef$current === void 0 ? void 0 : (_triggerRef$current$c = _triggerRef$current.close) === null || _triggerRef$current$c === void 0 ? void 0 : _triggerRef$current$c.call(_triggerRef$current);\n  }, [valueKey, isControlled, onChange, onSelect, onSelectItem, setValue, itemParentMap]);\n  var handleExpand = useCallback(function (node) {\n    var nextExpandItemValues = toggleExpand({\n      node: node,\n      isExpand: !node.expand,\n      expandItemValues: expandItemValues,\n      valueKey: valueKey\n    });\n    setExpandItemValues(nextExpandItemValues);\n    onExpand === null || onExpand === void 0 ? void 0 : onExpand(nextExpandItemValues, node, createConcatChildrenFunction(node, node[valueKey], {\n      valueKey: valueKey,\n      childrenKey: childrenKey\n    }));\n\n    if (_isFunction(getChildren) && !node.expand && Array.isArray(node[childrenKey]) && node[childrenKey].length === 0) {\n      loadChildren(node, getChildren);\n    }\n  }, [valueKey, childrenKey, expandItemValues, getChildren, onExpand, setExpandItemValues, loadChildren]);\n  var handleDragStart = useCallback(function (nodeData, event) {\n    if (draggable) {\n      var _event$dataTransfer;\n\n      var dragMoverNode = createDragPreview(stringifyTreeNodeLabel(nodeData[labelKey]), treePrefix('drag-preview'));\n      (_event$dataTransfer = event.dataTransfer) === null || _event$dataTransfer === void 0 ? void 0 : _event$dataTransfer.setDragImage(dragMoverNode, 0, 0);\n      setDragNodeKeys(getDragNodeKeys(nodeData, childrenKey, valueKey));\n      setDragNode(flattenNodes[nodeData.refKey]);\n      onDragStart === null || onDragStart === void 0 ? void 0 : onDragStart(nodeData, event);\n    }\n  }, [draggable, labelKey, treePrefix, setDragNodeKeys, childrenKey, valueKey, setDragNode, flattenNodes, onDragStart]);\n  var handleDragEnter = useCallback(function (nodeData, event) {\n    if (dragNodeKeys.some(function (d) {\n      return shallowEqual(d, nodeData[valueKey]);\n    })) {\n      return;\n    }\n\n    if (dragNode) {\n      setDragOverNodeKey(nodeData[valueKey]);\n      setDropNodePosition(calDropNodePosition(event, treeNodesRefs[nodeData.refKey]));\n    }\n\n    onDragEnter === null || onDragEnter === void 0 ? void 0 : onDragEnter(nodeData, event);\n  }, [dragNode, treeNodesRefs, dragNodeKeys, onDragEnter, setDragOverNodeKey, setDropNodePosition, valueKey]);\n  var handleDragOver = useCallback(function (nodeData, event) {\n    if (dragNodeKeys.some(function (d) {\n      return shallowEqual(d, nodeData[valueKey]);\n    })) {\n      event.dataTransfer.dropEffect = 'none';\n      return;\n    }\n\n    if (dragNode && shallowEqual(nodeData[valueKey], dragOverNodeKey)) {\n      var lastDropNodePosition = calDropNodePosition(event, treeNodesRefs[nodeData.refKey]);\n      if (lastDropNodePosition === dropNodePosition) return;\n      setDropNodePosition(lastDropNodePosition);\n    }\n\n    onDragOver === null || onDragOver === void 0 ? void 0 : onDragOver(nodeData, event);\n  }, [dragNode, dragNodeKeys, dragOverNodeKey, dropNodePosition, onDragOver, setDropNodePosition, treeNodesRefs, valueKey]);\n  var handleDragLeave = useCallback(function (nodeData, event) {\n    onDragLeave === null || onDragLeave === void 0 ? void 0 : onDragLeave(nodeData, event);\n  }, [onDragLeave]);\n  var handleDragEnd = useCallback(function (nodeData, event) {\n    removeDragPreview();\n    setDragNode(null);\n    setDragNodeKeys([]);\n    setDragOverNodeKey(null);\n    onDragEnd === null || onDragEnd === void 0 ? void 0 : onDragEnd(nodeData, event);\n  }, [setDragNode, setDragNodeKeys, setDragOverNodeKey, onDragEnd]);\n  var handleDrop = useCallback(function (nodeData, event) {\n    if (dragNodeKeys.some(function (d) {\n      return shallowEqual(d, nodeData[valueKey]);\n    })) {\n      console.error('Cannot drag a node to itself and its children');\n    } else {\n      var dropData = getDropData(nodeData);\n      onDrop === null || onDrop === void 0 ? void 0 : onDrop(dropData, event);\n    }\n\n    removeDragPreview();\n    setDragNode(null);\n    setDragNodeKeys([]);\n    setDragOverNodeKey(null);\n  }, [dragNodeKeys, setDragNode, setDragOverNodeKey, setDragNodeKeys, onDrop, getDropData, valueKey]);\n  var handleOpen = useCallback(function () {\n    var _triggerRef$current2, _triggerRef$current2$;\n\n    (_triggerRef$current2 = triggerRef.current) === null || _triggerRef$current2 === void 0 ? void 0 : (_triggerRef$current2$ = _triggerRef$current2.open) === null || _triggerRef$current2$ === void 0 ? void 0 : _triggerRef$current2$.call(_triggerRef$current2);\n    focusActiveNode();\n    onOpen === null || onOpen === void 0 ? void 0 : onOpen();\n    setActive(true);\n  }, [focusActiveNode, onOpen]);\n  var handleClose = useCallback(function () {\n    var _triggerRef$current3, _triggerRef$current3$, _targetRef$current2;\n\n    (_triggerRef$current3 = triggerRef.current) === null || _triggerRef$current3 === void 0 ? void 0 : (_triggerRef$current3$ = _triggerRef$current3.close) === null || _triggerRef$current3$ === void 0 ? void 0 : _triggerRef$current3$.call(_triggerRef$current3);\n    setSearchKeyword('');\n    setActive(false);\n    setFocusItemValue(activeNode === null || activeNode === void 0 ? void 0 : activeNode[valueKey]);\n    /**\n     * when using keyboard toggle picker, should refocus on PickerToggle Component after close picker menu\n     */\n\n    (_targetRef$current2 = targetRef.current) === null || _targetRef$current2 === void 0 ? void 0 : _targetRef$current2.focus();\n  }, [activeNode, setSearchKeyword, valueKey]);\n  usePublicMethods(ref, {\n    rootRef: inline ? treeViewRef : undefined,\n    triggerRef: triggerRef,\n    overlayRef: overlayRef,\n    targetRef: targetRef,\n    listRef: listRef,\n    inline: inline\n  });\n  var handleFocusItem = useCallback(function (key) {\n    var focusableItems = getFocusableItems(filteredData, {\n      disabledItemValues: disabledItemValues,\n      valueKey: valueKey,\n      childrenKey: childrenKey,\n      expandItemValues: expandItemValues\n    }, isSearching(searchKeywordState));\n    var selector = \".\" + treePrefix('node-label');\n    var focusProps = {\n      focusItemValue: focusItemValue,\n      focusableItems: focusableItems,\n      treeNodesRefs: treeNodesRefs,\n      selector: selector,\n      valueKey: valueKey,\n      callback: function callback(nextFocusItemValue) {\n        setFocusItemValue(nextFocusItemValue);\n      }\n    };\n\n    if (key === KEY_VALUES.DOWN) {\n      focusNextItem(focusProps);\n      return;\n    }\n\n    if (key === KEY_VALUES.UP) {\n      focusPreviousItem(focusProps);\n    }\n  }, [searchKeywordState, expandItemValues, filteredData, focusItemValue, treeNodesRefs, treePrefix, valueKey, childrenKey, disabledItemValues]);\n  var handleLeftArrow = useCallback(function () {\n    if (_isNil(focusItemValue)) return;\n    var focusItem = getActiveItem(focusItemValue, flattenNodes, valueKey);\n    leftArrowHandler({\n      focusItem: focusItem,\n      expand: expandItemValues.includes(focusItem === null || focusItem === void 0 ? void 0 : focusItem[valueKey]),\n      onExpand: handleExpand,\n      childrenKey: childrenKey,\n      onFocusItem: function onFocusItem() {\n        var _focusItem$parent, _focusItem$parent2;\n\n        setFocusItemValue(focusItem === null || focusItem === void 0 ? void 0 : (_focusItem$parent = focusItem.parent) === null || _focusItem$parent === void 0 ? void 0 : _focusItem$parent[valueKey]);\n        focusTreeNode(focusItem === null || focusItem === void 0 ? void 0 : (_focusItem$parent2 = focusItem.parent) === null || _focusItem$parent2 === void 0 ? void 0 : _focusItem$parent2.refKey, treeNodesRefs, \".\" + treePrefix('node-label'));\n      }\n    });\n  }, [expandItemValues, flattenNodes, focusItemValue, handleExpand, treeNodesRefs, treePrefix, valueKey, childrenKey]);\n  var handleRightArrow = useCallback(function () {\n    if (_isNil(focusItemValue)) return;\n    var focusItem = getActiveItem(focusItemValue, flattenNodes, valueKey);\n    rightArrowHandler({\n      focusItem: focusItem,\n      expand: expandItemValues.includes(focusItem === null || focusItem === void 0 ? void 0 : focusItem[valueKey]),\n      childrenKey: childrenKey,\n      onExpand: handleExpand,\n      onFocusItem: function onFocusItem() {\n        handleFocusItem(KEY_VALUES.DOWN);\n      }\n    });\n  }, [focusItemValue, flattenNodes, valueKey, expandItemValues, childrenKey, handleExpand, handleFocusItem]);\n  var selectActiveItem = useCallback(function (event) {\n    if (_isNil(focusItemValue)) return;\n    var activeItem = getActiveItem(focusItemValue, flattenNodes, valueKey);\n    handleSelect(activeItem, event);\n  }, [flattenNodes, valueKey, focusItemValue, handleSelect]);\n  var handleClean = useCallback(function (event) {\n    var nullValue = null;\n    var target = event.target; // exclude searchBar\n\n    if (target.matches('div[role=\"searchbox\"] > input') || disabled || !cleanable) {\n      return;\n    }\n\n    if (!isControlled) {\n      setValue(null);\n    }\n\n    onChange === null || onChange === void 0 ? void 0 : onChange(nullValue, event);\n  }, [cleanable, disabled, onChange, setValue, isControlled]);\n  var onPickerKeydown = useToggleKeyDownEvent(_extends({\n    toggle: !activeNode || !active,\n    triggerRef: triggerRef,\n    targetRef: targetRef,\n    overlayRef: overlayRef,\n    searchInputRef: searchInputRef,\n    active: active,\n    onExit: handleClean,\n    onClose: handleClose,\n    onMenuKeyDown: function onMenuKeyDown(event) {\n      _onMenuKeyDown(event, {\n        down: function down() {\n          return handleFocusItem(KEY_VALUES.DOWN);\n        },\n        up: function up() {\n          return handleFocusItem(KEY_VALUES.UP);\n        },\n        left: rtl ? handleRightArrow : handleLeftArrow,\n        right: rtl ? handleLeftArrow : handleRightArrow,\n        enter: selectActiveItem,\n        del: handleClean\n      });\n    }\n  }, rest));\n  var handleTreeKeyDown = useCallback(function (event) {\n    if (!treeViewRef.current) {\n      return;\n    }\n\n    _onMenuKeyDown(event, {\n      down: function down() {\n        return handleFocusItem(KEY_VALUES.DOWN);\n      },\n      up: function up() {\n        return handleFocusItem(KEY_VALUES.UP);\n      },\n      left: rtl ? handleRightArrow : handleLeftArrow,\n      right: rtl ? handleLeftArrow : handleRightArrow,\n      enter: selectActiveItem\n    });\n  }, [handleFocusItem, handleLeftArrow, handleRightArrow, rtl, selectActiveItem]);\n\n  var renderNode = function renderNode(node, index, layer) {\n    if (!node.visible) {\n      return null;\n    }\n\n    var children = node[childrenKey];\n    var expand = getExpandWhenSearching(searchKeywordState, expandItemValues.includes(node[valueKey]));\n    var visibleChildren = _isUndefined(searchKeywordState) || searchKeywordState.length === 0 ? !!children : hasVisibleChildren(node, childrenKey);\n\n    var nodeProps = _extends({}, getTreeNodeProps(_extends({}, node, {\n      expand: expand\n    }), layer, index), {\n      hasChildren: visibleChildren\n    });\n\n    if (nodeProps.hasChildren) {\n      var _merge;\n\n      layer += 1;\n      var openClass = treePrefix('open');\n      var childrenClass = merge(treePrefix('node-children'), (_merge = {}, _merge[openClass] = expand && visibleChildren, _merge));\n      var nodes = children || [];\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: childrenClass,\n        key: node[valueKey]\n      }, /*#__PURE__*/React.createElement(TreeNode, _extends({}, nodeProps, {\n        ref: function ref(_ref) {\n          return saveTreeNodeRef(_ref, node.refKey);\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: treePrefix('children')\n      }, nodes.map(function (child, i) {\n        return renderNode(child, i, layer);\n      }), showIndentLine && /*#__PURE__*/React.createElement(\"span\", {\n        className: treePrefix('indent-line'),\n        style: getTreeNodeIndent(rtl, layer - 1, true)\n      })));\n    }\n\n    return /*#__PURE__*/React.createElement(TreeNode, _extends({\n      ref: function ref(_ref2) {\n        return saveTreeNodeRef(_ref2, node.refKey);\n      },\n      key: node[valueKey]\n    }, nodeProps));\n  };\n\n  var renderVirtualListNode = function renderVirtualListNode(_ref3) {\n    var index = _ref3.index,\n        style = _ref3.style,\n        data = _ref3.data;\n    var node = data[index];\n    var layer = node.layer,\n        visible = node.visible;\n    var expand = getExpandWhenSearching(searchKeywordState, expandItemValues.includes(node[valueKey]));\n\n    if (!node.visible) {\n      return null;\n    }\n\n    var nodeProps = _extends({}, getTreeNodeProps(_extends({}, node, {\n      expand: expand\n    }), layer), {\n      style: style,\n      hasChildren: node.hasChildren\n    });\n\n    return visible && /*#__PURE__*/React.createElement(TreeNode, _extends({\n      ref: function ref(_ref4) {\n        return saveTreeNodeRef(_ref4, node.refKey);\n      }\n    }, nodeProps));\n  };\n\n  var renderTree = function renderTree() {\n    var _withTreeClassPrefix;\n\n    var classes = withTreeClassPrefix((_withTreeClassPrefix = {}, _withTreeClassPrefix[className !== null && className !== void 0 ? className : ''] = inline, _withTreeClassPrefix.virtualized = virtualized, _withTreeClassPrefix));\n    var formattedNodes = getFormattedNodes(renderNode);\n    var styles = inline ? _extends({\n      height: height\n    }, style) : {};\n    return /*#__PURE__*/React.createElement(\"div\", {\n      role: \"tree\",\n      id: id ? id + \"-listbox\" : undefined,\n      ref: treeViewRef,\n      className: classes,\n      style: styles,\n      onKeyDown: inline ? handleTreeKeyDown : undefined\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: treePrefix('nodes')\n    }, virtualized ? /*#__PURE__*/React.createElement(AutoSizer, {\n      defaultHeight: inline ? height : menuMaxHeight,\n      style: {\n        width: 'auto',\n        height: 'auto'\n      }\n    }, function (_ref5) {\n      var height = _ref5.height;\n      return /*#__PURE__*/React.createElement(List, _extends({\n        ref: listRef,\n        height: height,\n        itemSize: itemSize,\n        itemCount: formattedNodes.length,\n        itemData: formattedNodes\n      }, listProps), renderVirtualListNode);\n    }) : formattedNodes));\n  };\n\n  var renderDropdownMenu = function renderDropdownMenu(positionProps, speakerRef) {\n    var left = positionProps.left,\n        top = positionProps.top,\n        className = positionProps.className;\n    var classes = merge(className, menuClassName, prefix('tree-menu'));\n\n    var mergedMenuStyle = _extends({}, menuStyle, {\n      left: left,\n      top: top\n    });\n\n    return /*#__PURE__*/React.createElement(PickerOverlay, {\n      autoWidth: menuAutoWidth,\n      className: classes,\n      style: mergedMenuStyle,\n      ref: mergeRefs(overlayRef, speakerRef),\n      onKeyDown: onPickerKeydown,\n      target: triggerRef\n    }, searchable ? /*#__PURE__*/React.createElement(SearchBar, {\n      placeholder: locale.searchPlaceholder,\n      onChange: handleSearch,\n      value: searchKeywordState,\n      inputRef: searchInputRef\n    }) : null, renderMenu ? renderMenu(renderTree()) : renderTree(), renderExtraFooter === null || renderExtraFooter === void 0 ? void 0 : renderExtraFooter());\n  };\n  /**\n   * 1.Have a value and the value is valid.\n   * 2.Regardless of whether the value is valid, as long as renderValue is set, it is judged to have a value.\n   */\n\n\n  var hasValidValue = !_isNil(activeNode) || !_isNil(value) && _isFunction(renderValue);\n\n  var selectedElement = placeholder;\n\n  if (hasValidValue) {\n    var node = activeNode !== null && activeNode !== void 0 ? activeNode : {};\n    selectedElement = node[labelKey];\n\n    if (_isFunction(renderValue) && value) {\n      selectedElement = renderValue(value, node, selectedElement);\n\n      if (_isNil(selectedElement)) {\n        hasValidValue = false;\n      }\n    }\n  }\n\n  var _usePickerClassName = usePickerClassName(_extends({}, props, {\n    classPrefix: classPrefix,\n    appearance: appearance,\n    hasValue: hasValidValue,\n    name: 'tree',\n    cleanable: cleanable\n  })),\n      classes = _usePickerClassName[0],\n      usedClassNamePropKeys = _usePickerClassName[1];\n\n  if (inline) {\n    return renderTree();\n  }\n\n  return /*#__PURE__*/React.createElement(PickerToggleTrigger, {\n    pickerProps: _pick(props, pickTriggerPropKeys),\n    ref: triggerRef,\n    placement: placement,\n    onEnter: handleOpen,\n    onEntered: onEntered,\n    onExit: createChainedFunction(onClose, onExit),\n    onExited: createChainedFunction(handleClose, onExited),\n    speaker: renderDropdownMenu\n  }, /*#__PURE__*/React.createElement(Component, {\n    className: classes,\n    style: style\n  }, /*#__PURE__*/React.createElement(PickerToggle, _extends({}, _omit(rest, [].concat(omitTriggerPropKeys, usedClassNamePropKeys, ['cascade'])), {\n    id: id,\n    ref: targetRef,\n    appearance: appearance,\n    onKeyDown: onPickerKeydown,\n    onClean: createChainedFunction(handleClean, onClean),\n    cleanable: cleanable && !disabled,\n    as: toggleAs,\n    disabled: disabled,\n    hasValue: hasValidValue,\n    active: active,\n    placement: placement,\n    inputValue: value\n  }), selectedElement || locale.placeholder)));\n});\nTreePicker.displayName = 'TreePicker';\nTreePicker.propTypes = _extends({}, listPickerPropTypes, {\n  locale: PropTypes.any,\n  appearance: PropTypes.oneOf(['default', 'subtle']),\n  height: PropTypes.number,\n  draggable: PropTypes.bool,\n  virtualized: PropTypes.bool,\n  searchable: PropTypes.bool,\n  menuAutoWidth: PropTypes.bool,\n  searchKeyword: PropTypes.string,\n  defaultExpandAll: PropTypes.bool,\n  expandItemValues: PropTypes.array,\n  defaultExpandItemValues: PropTypes.array,\n  onSearch: PropTypes.func,\n  onExpand: PropTypes.func,\n  onSelect: PropTypes.func,\n  renderMenu: PropTypes.func,\n  renderTreeNode: PropTypes.func,\n  renderTreeIcon: PropTypes.func,\n  renderExtraFooter: PropTypes.func,\n  renderDragNode: PropTypes.func,\n  searchBy: PropTypes.func\n});\nexport default TreePicker;"]},"metadata":{},"sourceType":"module"}