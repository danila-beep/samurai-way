{"ast":null,"code":"import { useRef, useCallback, useState, useEffect } from 'react';\nimport WheelHandler from 'dom-lib/WheelHandler';\nimport scrollLeft from 'dom-lib/scrollLeft';\nimport scrollTop from 'dom-lib/scrollTop';\nimport on from 'dom-lib/on';\nimport removeStyle from 'dom-lib/removeStyle';\nimport { requestAnimationTimeout, cancelAnimationTimeout } from './requestAnimationTimeout';\nimport useUpdateEffect from './useUpdateEffect';\nimport useMount from './useMount';\nimport { SCROLLBAR_WIDTH, TRANSITION_DURATION, BEZIER } from '../constants';\nimport isSupportTouchEvent from './isSupportTouchEvent';\nimport flushSync from './flushSync';\nimport defer from './defer'; // Inertial sliding start time threshold\n\nvar momentumTimeThreshold = 300; // Inertial sliding start vertical distance threshold\n\nvar momentumYThreshold = 15;\n/**\n * Calculate the distance of inertial sliding.\n */\n\nvar momentum = function momentum(current, start, duration) {\n  // Inertial sliding acceleration.\n  var deceleration = 0.003;\n  var distance = current - start;\n  var speed = 2 * Math.abs(distance) / duration;\n  var destination = current + speed / deceleration * (distance < 0 ? -1 : 1);\n  return {\n    delta: current - destination,\n    duration: TRANSITION_DURATION,\n    bezier: BEZIER\n  };\n};\n/**\n * Add scroll, touch, and wheel monitoring events to the table,\n * and update the scroll position of the table.\n * @param props\n * @returns\n */\n\n\nvar useScrollListener = function useScrollListener(props) {\n  var data = props.data,\n      autoHeight = props.autoHeight,\n      tableBodyRef = props.tableBodyRef,\n      scrollbarXRef = props.scrollbarXRef,\n      scrollbarYRef = props.scrollbarYRef,\n      disabledScroll = props.disabledScroll,\n      loading = props.loading,\n      tableRef = props.tableRef,\n      contentWidth = props.contentWidth,\n      tableWidth = props.tableWidth,\n      scrollY = props.scrollY,\n      minScrollY = props.minScrollY,\n      minScrollX = props.minScrollX,\n      scrollX = props.scrollX,\n      setScrollX = props.setScrollX,\n      setScrollY = props.setScrollY,\n      virtualized = props.virtualized,\n      forceUpdatePosition = props.forceUpdatePosition,\n      deferUpdatePosition = props.deferUpdatePosition,\n      onScroll = props.onScroll,\n      onTouchMove = props.onTouchMove,\n      onTouchStart = props.onTouchStart,\n      onTouchEnd = props.onTouchEnd,\n      height = props.height,\n      getTableHeight = props.getTableHeight,\n      contentHeight = props.contentHeight,\n      headerHeight = props.headerHeight,\n      rtl = props.rtl;\n  var wheelListener = useRef();\n  var touchStartListener = useRef();\n  var touchMoveListener = useRef();\n  var touchEndListener = useRef();\n\n  var _useState = useState(false),\n      isScrolling = _useState[0],\n      setScrolling = _useState[1];\n\n  var touchX = useRef(0);\n  var touchY = useRef(0);\n  var disableEventsTimeoutId = useRef(null);\n  var isTouching = useRef(false); // The start time within the inertial sliding range.\n\n  var momentumStartTime = useRef(0); // The vertical starting value within the inertial sliding range.\n\n  var momentumStartY = useRef(0);\n  var shouldHandleWheelX = useCallback(function (delta) {\n    if (delta === 0 || disabledScroll || loading) {\n      return false;\n    }\n\n    return true;\n  }, [disabledScroll, loading]);\n  var shouldHandleWheelY = useCallback(function (delta) {\n    if (delta === 0 || disabledScroll || loading || autoHeight) {\n      return false;\n    }\n\n    if (typeof scrollY.current === 'number' && typeof minScrollY.current === 'number') {\n      return delta >= 0 && scrollY.current > minScrollY.current || delta < 0 && scrollY.current < 0;\n    }\n  }, [autoHeight, disabledScroll, loading, minScrollY, scrollY]);\n  var debounceScrollEndedCallback = useCallback(function () {\n    disableEventsTimeoutId.current = null; // Forces the end of scrolling to be prioritized so that virtualized long lists can update rendering.\n    // There will be no scrolling white screen.\n\n    flushSync(function () {\n      return setScrolling(false);\n    });\n  }, []);\n  /**\n   * Triggered when scrolling, including: wheel/touch/scroll\n   * @param deltaX\n   * @param deltaY\n   * @param momentumOptions The configuration of inertial scrolling is used for the touch event.\n   */\n\n  var handleWheel = useCallback(function (deltaX, deltaY, momentumOptions, event) {\n    if (!tableRef.current) {\n      return;\n    }\n\n    var nextScrollX = contentWidth.current <= tableWidth.current ? 0 : scrollX.current - deltaX;\n    var nextScrollY = scrollY.current - deltaY;\n    var y = Math.min(0, nextScrollY < minScrollY.current ? minScrollY.current : nextScrollY);\n    var x = Math.min(0, nextScrollX < minScrollX.current ? minScrollX.current : nextScrollX);\n    setScrollX(x);\n    setScrollY(y);\n    onScroll === null || onScroll === void 0 ? void 0 : onScroll(Math.abs(x), Math.abs(y));\n\n    if (virtualized) {\n      // Add a state to the table during virtualized scrolling.\n      // Make it set CSS `pointer-events:none` on the DOM to avoid wrong event interaction.\n      flushSync(function () {\n        return setScrolling(true);\n      });\n\n      if (disableEventsTimeoutId.current) {\n        cancelAnimationTimeout(disableEventsTimeoutId.current);\n      }\n\n      disableEventsTimeoutId.current = requestAnimationTimeout(debounceScrollEndedCallback, // When momentum is enabled, set a delay of 50ms rendering.\n      momentumOptions !== null && momentumOptions !== void 0 && momentumOptions.duration ? 50 : 0);\n    } // When the user clicks on the scrollbar, the scrollbar will be moved to the clicked position.\n\n\n    if ((event === null || event === void 0 ? void 0 : event.type) === 'click') {\n      /**\n       * With virtualized enabled, the list will be re-rendered on every scroll.\n       * Update the position of the rendered list with a delay.\n       * fix: https://github.com/rsuite/rsuite/issues/2378\n       */\n      deferUpdatePosition(momentumOptions === null || momentumOptions === void 0 ? void 0 : momentumOptions.duration, momentumOptions === null || momentumOptions === void 0 ? void 0 : momentumOptions.bezier);\n      return;\n    }\n\n    forceUpdatePosition(momentumOptions === null || momentumOptions === void 0 ? void 0 : momentumOptions.duration, momentumOptions === null || momentumOptions === void 0 ? void 0 : momentumOptions.bezier);\n  }, [tableRef, contentWidth, tableWidth, scrollX, scrollY, minScrollY, minScrollX, setScrollX, setScrollY, onScroll, forceUpdatePosition, deferUpdatePosition, virtualized, debounceScrollEndedCallback]);\n  var onWheel = useCallback(function (deltaX, deltaY, momentumOptions) {\n    var _scrollbarXRef$curren, _scrollbarXRef$curren2, _scrollbarYRef$curren, _scrollbarYRef$curren2;\n\n    handleWheel(deltaX, deltaY, momentumOptions);\n    (_scrollbarXRef$curren = scrollbarXRef.current) === null || _scrollbarXRef$curren === void 0 ? void 0 : (_scrollbarXRef$curren2 = _scrollbarXRef$curren.onWheelScroll) === null || _scrollbarXRef$curren2 === void 0 ? void 0 : _scrollbarXRef$curren2.call(_scrollbarXRef$curren, deltaX);\n    (_scrollbarYRef$curren = scrollbarYRef.current) === null || _scrollbarYRef$curren === void 0 ? void 0 : (_scrollbarYRef$curren2 = _scrollbarYRef$curren.onWheelScroll) === null || _scrollbarYRef$curren2 === void 0 ? void 0 : _scrollbarYRef$curren2.call(_scrollbarYRef$curren, deltaY, momentumOptions !== null && momentumOptions !== void 0 && momentumOptions.duration ? true : false);\n  }, [handleWheel, scrollbarXRef, scrollbarYRef]);\n  var wheelHandler = useRef(); // Stop unending scrolling and remove transition\n\n  var stopScroll = useCallback(function () {\n    var _tableBodyRef$current, _scrollbarYRef$curren3;\n\n    var wheelElement = (_tableBodyRef$current = tableBodyRef.current) === null || _tableBodyRef$current === void 0 ? void 0 : _tableBodyRef$current.querySelector('.rs-table-body-wheel-area');\n    var handleElement = (_scrollbarYRef$curren3 = scrollbarYRef.current) === null || _scrollbarYRef$curren3 === void 0 ? void 0 : _scrollbarYRef$curren3.handle;\n    var transitionCSS = ['transition-duration', 'transition-timing-function'];\n\n    if (!virtualized && wheelElement) {\n      // Get the current translate position.\n      var matrix = window.getComputedStyle(wheelElement).getPropertyValue('transform');\n      var offsetY = Math.round(+matrix.split(')')[0].split(', ')[5]);\n      setScrollY(offsetY);\n    }\n\n    if (wheelElement) {\n      removeStyle(wheelElement, transitionCSS);\n    }\n\n    if (handleElement) {\n      removeStyle(handleElement, transitionCSS);\n    }\n  }, [scrollbarYRef, setScrollY, tableBodyRef, virtualized]); // Handle the Touch event and initialize it when touchstart is triggered.\n\n  var handleTouchStart = useCallback(function (event) {\n    var _event$touches$ = event.touches[0],\n        pageX = _event$touches$.pageX,\n        pageY = _event$touches$.pageY;\n    touchX.current = pageX;\n    touchY.current = pageY;\n    momentumStartTime.current = new Date().getTime();\n    momentumStartY.current = scrollY.current;\n    isTouching.current = true;\n    onTouchStart === null || onTouchStart === void 0 ? void 0 : onTouchStart(event); // Stop unfinished scrolling when Touch starts.\n\n    stopScroll();\n  }, [onTouchStart, scrollY, stopScroll]); // Handle the Touch event and update the scroll when touchmove is triggered.\n\n  var handleTouchMove = useCallback(function (event) {\n    if (!isTouching.current) {\n      return;\n    }\n\n    var _event$touches$2 = event.touches[0],\n        pageX = _event$touches$2.pageX,\n        pageY = _event$touches$2.pageY;\n    var deltaX = touchX.current - pageX;\n    var deltaY = autoHeight ? 0 : touchY.current - pageY;\n\n    if (!shouldHandleWheelY(deltaY) && !shouldHandleWheelX(deltaX)) {\n      return;\n    }\n    /**\n     * Prevent the default touch event when the table is scrollable.\n     * fix: https://github.com/rsuite/rsuite-table/commit/21785fc18f430519ab5885c44540d9ffc30de366#commitcomment-36236425\n     */\n\n\n    if (!autoHeight && shouldHandleWheelY(deltaY)) {\n      var _event$preventDefault;\n\n      (_event$preventDefault = event.preventDefault) === null || _event$preventDefault === void 0 ? void 0 : _event$preventDefault.call(event);\n    }\n\n    var now = new Date().getTime();\n    onWheel(deltaX, deltaY);\n    touchX.current = pageX;\n    touchY.current = pageY; // Record the offset value and time under the condition of triggering inertial scrolling.\n\n    if (now - momentumStartTime.current > momentumTimeThreshold) {\n      momentumStartY.current = scrollY.current;\n      momentumStartTime.current = now;\n    }\n\n    onTouchMove === null || onTouchMove === void 0 ? void 0 : onTouchMove(event);\n  }, [autoHeight, onWheel, onTouchMove, scrollY, shouldHandleWheelX, shouldHandleWheelY]);\n  var handleTouchEnd = useCallback(function (event) {\n    if (!isTouching.current) {\n      return;\n    }\n\n    isTouching.current = false;\n    var touchDuration = new Date().getTime() - momentumStartTime.current;\n    var absDeltaY = Math.abs(scrollY.current - momentumStartY.current); // Enable inertial sliding.\n\n    if (touchDuration < momentumTimeThreshold && absDeltaY > momentumYThreshold) {\n      var _momentum = momentum(scrollY.current, momentumStartY.current, touchDuration),\n          delta = _momentum.delta,\n          duration = _momentum.duration,\n          bezier = _momentum.bezier;\n\n      onWheel(0, delta, {\n        duration: duration,\n        bezier: bezier\n      });\n      onTouchEnd === null || onTouchEnd === void 0 ? void 0 : onTouchEnd(event);\n    }\n  }, [onWheel, onTouchEnd, scrollY]);\n  /**\n   * When the user uses the tab key in the Table, the onScroll event is triggered,\n   * and the scroll bar position should be updated at the same time.\n   * https://github.com/rsuite/rsuite/issues/234\n   */\n\n  var onScrollBody = useCallback(function (event) {\n    if (event.target !== tableBodyRef.current) {\n      return;\n    }\n\n    var left = scrollLeft(event.target);\n    var top = scrollTop(event.target);\n\n    if (top === 0 && left === 0) {\n      return;\n    }\n\n    onWheel(left, top);\n    scrollLeft(event.target, 0);\n    scrollTop(event.target, 0);\n  }, [onWheel, tableBodyRef]);\n  var getControlledScrollTopValue = useCallback(function (value) {\n    if (autoHeight) {\n      return [0, 0];\n    }\n\n    var height = getTableHeight(); // The maximum range of scrolling value is judged.\n\n    value = Math.min(value, Math.max(0, contentHeight.current - (height - headerHeight))); // The value is a value of the theoretical scroll position of the table,\n    // and the scrollY coordinate value and the value of the scroll bar position are calculated by value.\n\n    return [-value, value / contentHeight.current * (height - headerHeight)];\n  }, [autoHeight, contentHeight, getTableHeight, headerHeight]);\n\n  var rerender = function rerender() {\n    setScrolling(true);\n    defer(function () {\n      if (tableBodyRef.current) {\n        setScrolling(false);\n      }\n    });\n  };\n\n  var getControlledScrollLeftValue = function getControlledScrollLeftValue(value) {\n    // The maximum range of scrolling value is judged.\n    value = Math.min(value, Math.max(0, contentWidth.current - tableWidth.current));\n    return [-value, value / contentWidth.current * tableWidth.current];\n  };\n\n  var onScrollTop = function onScrollTop(top) {\n    var _scrollbarYRef$curren4, _scrollbarYRef$curren5;\n\n    if (top === void 0) {\n      top = 0;\n    }\n\n    var _getControlledScrollT = getControlledScrollTopValue(top),\n        nextScrollY = _getControlledScrollT[0],\n        handleScrollY = _getControlledScrollT[1];\n\n    var height = getTableHeight();\n\n    if (!loading && nextScrollY !== scrollY.current) {\n      onScroll === null || onScroll === void 0 ? void 0 : onScroll(Math.abs(scrollX.current), Math.abs(nextScrollY));\n    }\n\n    setScrollY(nextScrollY);\n    scrollbarYRef === null || scrollbarYRef === void 0 ? void 0 : (_scrollbarYRef$curren4 = scrollbarYRef.current) === null || _scrollbarYRef$curren4 === void 0 ? void 0 : (_scrollbarYRef$curren5 = _scrollbarYRef$curren4.resetScrollBarPosition) === null || _scrollbarYRef$curren5 === void 0 ? void 0 : _scrollbarYRef$curren5.call(_scrollbarYRef$curren4, handleScrollY);\n    deferUpdatePosition();\n    /**\n     * After calling `scrollTop`, a white screen will appear when `virtualized` is true.\n     * The reason is that the coordinates of the DOM are directly manipulated,\n     * but the component is not re-rendered. Need to call `rerender`.\n     * Fix: rsuite#1044\n     */\n\n    if (virtualized && contentHeight.current > height) {\n      rerender();\n    }\n  };\n\n  var onScrollLeft = function onScrollLeft(left) {\n    var _scrollbarXRef$curren3, _scrollbarXRef$curren4;\n\n    if (left === void 0) {\n      left = 0;\n    }\n\n    var _getControlledScrollL = getControlledScrollLeftValue(left),\n        nextScrollX = _getControlledScrollL[0],\n        scrollbarX = _getControlledScrollL[1];\n\n    setScrollX(nextScrollX);\n    !loading && (onScroll === null || onScroll === void 0 ? void 0 : onScroll(Math.abs(nextScrollX), Math.abs(scrollY.current)));\n    scrollbarXRef === null || scrollbarXRef === void 0 ? void 0 : (_scrollbarXRef$curren3 = scrollbarXRef.current) === null || _scrollbarXRef$curren3 === void 0 ? void 0 : (_scrollbarXRef$curren4 = _scrollbarXRef$curren3.resetScrollBarPosition) === null || _scrollbarXRef$curren4 === void 0 ? void 0 : _scrollbarXRef$curren4.call(_scrollbarXRef$curren3, scrollbarX);\n    deferUpdatePosition();\n  };\n\n  var onScrollTo = function onScrollTo(coord) {\n    var _ref = coord || {},\n        x = _ref.x,\n        y = _ref.y;\n\n    if (typeof x === 'number') {\n      onScrollLeft(x);\n    }\n\n    if (typeof y === 'number') {\n      onScrollTop(y);\n    }\n  };\n\n  useUpdateEffect(function () {\n    if (scrollY.current !== 0) {\n      onScrollTop(Math.abs(scrollY.current));\n    } // fix: #405 #404\n\n\n    deferUpdatePosition();\n  }, [height, data]);\n  var releaseListeners = useCallback(function () {\n    var _wheelListener$curren, _touchStartListener$c, _touchMoveListener$cu, _touchEndListener$cur;\n\n    wheelHandler.current = null;\n    (_wheelListener$curren = wheelListener.current) === null || _wheelListener$curren === void 0 ? void 0 : _wheelListener$curren.off();\n    (_touchStartListener$c = touchStartListener.current) === null || _touchStartListener$c === void 0 ? void 0 : _touchStartListener$c.off();\n    (_touchMoveListener$cu = touchMoveListener.current) === null || _touchMoveListener$cu === void 0 ? void 0 : _touchMoveListener$cu.off();\n    (_touchEndListener$cur = touchEndListener.current) === null || _touchEndListener$cur === void 0 ? void 0 : _touchEndListener$cur.off();\n  }, []);\n  useEffect(function () {\n    var options = {\n      passive: false\n    };\n    var tableBody = tableBodyRef.current;\n\n    if (tableBody) {\n      // Reset the listener after props is updated.\n      releaseListeners();\n      wheelHandler.current = new WheelHandler(onWheel, shouldHandleWheelX, shouldHandleWheelY, false);\n      wheelListener.current = on(tableBody, 'wheel', wheelHandler.current.onWheel, options);\n\n      if (isSupportTouchEvent()) {\n        touchStartListener.current = on(tableBody, 'touchstart', handleTouchStart, options);\n        touchMoveListener.current = on(tableBody, 'touchmove', handleTouchMove, options);\n        touchEndListener.current = on(tableBody, 'touchend', handleTouchEnd, options);\n      }\n    }\n\n    return releaseListeners;\n  }, [handleTouchEnd, handleTouchMove, handleTouchStart, onWheel, releaseListeners, shouldHandleWheelX, shouldHandleWheelY, tableBodyRef]);\n  useMount(function () {\n    if (rtl) {\n      var _scrollbarXRef$curren5, _scrollbarXRef$curren6; // Initialize scroll position\n\n\n      setScrollX(tableWidth.current - contentWidth.current - SCROLLBAR_WIDTH);\n      scrollbarXRef === null || scrollbarXRef === void 0 ? void 0 : (_scrollbarXRef$curren5 = scrollbarXRef.current) === null || _scrollbarXRef$curren5 === void 0 ? void 0 : (_scrollbarXRef$curren6 = _scrollbarXRef$curren5.resetScrollBarPosition) === null || _scrollbarXRef$curren6 === void 0 ? void 0 : _scrollbarXRef$curren6.call(_scrollbarXRef$curren5, -scrollX.current);\n      forceUpdatePosition();\n    }\n  });\n  var onScrollHorizontal = useCallback(function (delta) {\n    return handleWheel(delta, 0);\n  }, [handleWheel]);\n  var onScrollVertical = useCallback(function (delta, event) {\n    return handleWheel(0, delta, undefined, event);\n  }, [handleWheel]);\n  return {\n    isScrolling: isScrolling,\n    onScrollHorizontal: onScrollHorizontal,\n    onScrollVertical: onScrollVertical,\n    onScrollBody: onScrollBody,\n    onScrollTop: onScrollTop,\n    onScrollLeft: onScrollLeft,\n    onScrollTo: onScrollTo\n  };\n};\n\nexport default useScrollListener;","map":{"version":3,"sources":["/Users/danilnagovicyn/Desktop/reactprojects/Incubator/Samurai_way/samurai-way/node_modules/rsuite-table/es/utils/useScrollListener.js"],"names":["useRef","useCallback","useState","useEffect","WheelHandler","scrollLeft","scrollTop","on","removeStyle","requestAnimationTimeout","cancelAnimationTimeout","useUpdateEffect","useMount","SCROLLBAR_WIDTH","TRANSITION_DURATION","BEZIER","isSupportTouchEvent","flushSync","defer","momentumTimeThreshold","momentumYThreshold","momentum","current","start","duration","deceleration","distance","speed","Math","abs","destination","delta","bezier","useScrollListener","props","data","autoHeight","tableBodyRef","scrollbarXRef","scrollbarYRef","disabledScroll","loading","tableRef","contentWidth","tableWidth","scrollY","minScrollY","minScrollX","scrollX","setScrollX","setScrollY","virtualized","forceUpdatePosition","deferUpdatePosition","onScroll","onTouchMove","onTouchStart","onTouchEnd","height","getTableHeight","contentHeight","headerHeight","rtl","wheelListener","touchStartListener","touchMoveListener","touchEndListener","_useState","isScrolling","setScrolling","touchX","touchY","disableEventsTimeoutId","isTouching","momentumStartTime","momentumStartY","shouldHandleWheelX","shouldHandleWheelY","debounceScrollEndedCallback","handleWheel","deltaX","deltaY","momentumOptions","event","nextScrollX","nextScrollY","y","min","x","type","onWheel","_scrollbarXRef$curren","_scrollbarXRef$curren2","_scrollbarYRef$curren","_scrollbarYRef$curren2","onWheelScroll","call","wheelHandler","stopScroll","_tableBodyRef$current","_scrollbarYRef$curren3","wheelElement","querySelector","handleElement","handle","transitionCSS","matrix","window","getComputedStyle","getPropertyValue","offsetY","round","split","handleTouchStart","_event$touches$","touches","pageX","pageY","Date","getTime","handleTouchMove","_event$touches$2","_event$preventDefault","preventDefault","now","handleTouchEnd","touchDuration","absDeltaY","_momentum","onScrollBody","target","left","top","getControlledScrollTopValue","value","max","rerender","getControlledScrollLeftValue","onScrollTop","_scrollbarYRef$curren4","_scrollbarYRef$curren5","_getControlledScrollT","handleScrollY","resetScrollBarPosition","onScrollLeft","_scrollbarXRef$curren3","_scrollbarXRef$curren4","_getControlledScrollL","scrollbarX","onScrollTo","coord","_ref","releaseListeners","_wheelListener$curren","_touchStartListener$c","_touchMoveListener$cu","_touchEndListener$cur","off","options","passive","tableBody","_scrollbarXRef$curren5","_scrollbarXRef$curren6","onScrollHorizontal","onScrollVertical","undefined"],"mappings":"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","sourcesContent":["import { useRef, useCallback, useState, useEffect } from 'react';\nimport WheelHandler from 'dom-lib/WheelHandler';\nimport scrollLeft from 'dom-lib/scrollLeft';\nimport scrollTop from 'dom-lib/scrollTop';\nimport on from 'dom-lib/on';\nimport removeStyle from 'dom-lib/removeStyle';\nimport { requestAnimationTimeout, cancelAnimationTimeout } from './requestAnimationTimeout';\nimport useUpdateEffect from './useUpdateEffect';\nimport useMount from './useMount';\nimport { SCROLLBAR_WIDTH, TRANSITION_DURATION, BEZIER } from '../constants';\nimport isSupportTouchEvent from './isSupportTouchEvent';\nimport flushSync from './flushSync';\nimport defer from './defer'; // Inertial sliding start time threshold\n\nvar momentumTimeThreshold = 300; // Inertial sliding start vertical distance threshold\n\nvar momentumYThreshold = 15;\n\n/**\n * Calculate the distance of inertial sliding.\n */\nvar momentum = function momentum(current, start, duration) {\n  // Inertial sliding acceleration.\n  var deceleration = 0.003;\n  var distance = current - start;\n  var speed = 2 * Math.abs(distance) / duration;\n  var destination = current + speed / deceleration * (distance < 0 ? -1 : 1);\n  return {\n    delta: current - destination,\n    duration: TRANSITION_DURATION,\n    bezier: BEZIER\n  };\n};\n/**\n * Add scroll, touch, and wheel monitoring events to the table,\n * and update the scroll position of the table.\n * @param props\n * @returns\n */\n\n\nvar useScrollListener = function useScrollListener(props) {\n  var data = props.data,\n      autoHeight = props.autoHeight,\n      tableBodyRef = props.tableBodyRef,\n      scrollbarXRef = props.scrollbarXRef,\n      scrollbarYRef = props.scrollbarYRef,\n      disabledScroll = props.disabledScroll,\n      loading = props.loading,\n      tableRef = props.tableRef,\n      contentWidth = props.contentWidth,\n      tableWidth = props.tableWidth,\n      scrollY = props.scrollY,\n      minScrollY = props.minScrollY,\n      minScrollX = props.minScrollX,\n      scrollX = props.scrollX,\n      setScrollX = props.setScrollX,\n      setScrollY = props.setScrollY,\n      virtualized = props.virtualized,\n      forceUpdatePosition = props.forceUpdatePosition,\n      deferUpdatePosition = props.deferUpdatePosition,\n      onScroll = props.onScroll,\n      onTouchMove = props.onTouchMove,\n      onTouchStart = props.onTouchStart,\n      onTouchEnd = props.onTouchEnd,\n      height = props.height,\n      getTableHeight = props.getTableHeight,\n      contentHeight = props.contentHeight,\n      headerHeight = props.headerHeight,\n      rtl = props.rtl;\n  var wheelListener = useRef();\n  var touchStartListener = useRef();\n  var touchMoveListener = useRef();\n  var touchEndListener = useRef();\n\n  var _useState = useState(false),\n      isScrolling = _useState[0],\n      setScrolling = _useState[1];\n\n  var touchX = useRef(0);\n  var touchY = useRef(0);\n  var disableEventsTimeoutId = useRef(null);\n  var isTouching = useRef(false); // The start time within the inertial sliding range.\n\n  var momentumStartTime = useRef(0); // The vertical starting value within the inertial sliding range.\n\n  var momentumStartY = useRef(0);\n  var shouldHandleWheelX = useCallback(function (delta) {\n    if (delta === 0 || disabledScroll || loading) {\n      return false;\n    }\n\n    return true;\n  }, [disabledScroll, loading]);\n  var shouldHandleWheelY = useCallback(function (delta) {\n    if (delta === 0 || disabledScroll || loading || autoHeight) {\n      return false;\n    }\n\n    if (typeof scrollY.current === 'number' && typeof minScrollY.current === 'number') {\n      return delta >= 0 && scrollY.current > minScrollY.current || delta < 0 && scrollY.current < 0;\n    }\n  }, [autoHeight, disabledScroll, loading, minScrollY, scrollY]);\n  var debounceScrollEndedCallback = useCallback(function () {\n    disableEventsTimeoutId.current = null; // Forces the end of scrolling to be prioritized so that virtualized long lists can update rendering.\n    // There will be no scrolling white screen.\n\n    flushSync(function () {\n      return setScrolling(false);\n    });\n  }, []);\n  /**\n   * Triggered when scrolling, including: wheel/touch/scroll\n   * @param deltaX\n   * @param deltaY\n   * @param momentumOptions The configuration of inertial scrolling is used for the touch event.\n   */\n\n  var handleWheel = useCallback(function (deltaX, deltaY, momentumOptions, event) {\n    if (!tableRef.current) {\n      return;\n    }\n\n    var nextScrollX = contentWidth.current <= tableWidth.current ? 0 : scrollX.current - deltaX;\n    var nextScrollY = scrollY.current - deltaY;\n    var y = Math.min(0, nextScrollY < minScrollY.current ? minScrollY.current : nextScrollY);\n    var x = Math.min(0, nextScrollX < minScrollX.current ? minScrollX.current : nextScrollX);\n    setScrollX(x);\n    setScrollY(y);\n    onScroll === null || onScroll === void 0 ? void 0 : onScroll(Math.abs(x), Math.abs(y));\n\n    if (virtualized) {\n      // Add a state to the table during virtualized scrolling.\n      // Make it set CSS `pointer-events:none` on the DOM to avoid wrong event interaction.\n      flushSync(function () {\n        return setScrolling(true);\n      });\n\n      if (disableEventsTimeoutId.current) {\n        cancelAnimationTimeout(disableEventsTimeoutId.current);\n      }\n\n      disableEventsTimeoutId.current = requestAnimationTimeout(debounceScrollEndedCallback, // When momentum is enabled, set a delay of 50ms rendering.\n      momentumOptions !== null && momentumOptions !== void 0 && momentumOptions.duration ? 50 : 0);\n    } // When the user clicks on the scrollbar, the scrollbar will be moved to the clicked position.\n\n\n    if ((event === null || event === void 0 ? void 0 : event.type) === 'click') {\n      /**\n       * With virtualized enabled, the list will be re-rendered on every scroll.\n       * Update the position of the rendered list with a delay.\n       * fix: https://github.com/rsuite/rsuite/issues/2378\n       */\n      deferUpdatePosition(momentumOptions === null || momentumOptions === void 0 ? void 0 : momentumOptions.duration, momentumOptions === null || momentumOptions === void 0 ? void 0 : momentumOptions.bezier);\n      return;\n    }\n\n    forceUpdatePosition(momentumOptions === null || momentumOptions === void 0 ? void 0 : momentumOptions.duration, momentumOptions === null || momentumOptions === void 0 ? void 0 : momentumOptions.bezier);\n  }, [tableRef, contentWidth, tableWidth, scrollX, scrollY, minScrollY, minScrollX, setScrollX, setScrollY, onScroll, forceUpdatePosition, deferUpdatePosition, virtualized, debounceScrollEndedCallback]);\n  var onWheel = useCallback(function (deltaX, deltaY, momentumOptions) {\n    var _scrollbarXRef$curren, _scrollbarXRef$curren2, _scrollbarYRef$curren, _scrollbarYRef$curren2;\n\n    handleWheel(deltaX, deltaY, momentumOptions);\n    (_scrollbarXRef$curren = scrollbarXRef.current) === null || _scrollbarXRef$curren === void 0 ? void 0 : (_scrollbarXRef$curren2 = _scrollbarXRef$curren.onWheelScroll) === null || _scrollbarXRef$curren2 === void 0 ? void 0 : _scrollbarXRef$curren2.call(_scrollbarXRef$curren, deltaX);\n    (_scrollbarYRef$curren = scrollbarYRef.current) === null || _scrollbarYRef$curren === void 0 ? void 0 : (_scrollbarYRef$curren2 = _scrollbarYRef$curren.onWheelScroll) === null || _scrollbarYRef$curren2 === void 0 ? void 0 : _scrollbarYRef$curren2.call(_scrollbarYRef$curren, deltaY, momentumOptions !== null && momentumOptions !== void 0 && momentumOptions.duration ? true : false);\n  }, [handleWheel, scrollbarXRef, scrollbarYRef]);\n  var wheelHandler = useRef(); // Stop unending scrolling and remove transition\n\n  var stopScroll = useCallback(function () {\n    var _tableBodyRef$current, _scrollbarYRef$curren3;\n\n    var wheelElement = (_tableBodyRef$current = tableBodyRef.current) === null || _tableBodyRef$current === void 0 ? void 0 : _tableBodyRef$current.querySelector('.rs-table-body-wheel-area');\n    var handleElement = (_scrollbarYRef$curren3 = scrollbarYRef.current) === null || _scrollbarYRef$curren3 === void 0 ? void 0 : _scrollbarYRef$curren3.handle;\n    var transitionCSS = ['transition-duration', 'transition-timing-function'];\n\n    if (!virtualized && wheelElement) {\n      // Get the current translate position.\n      var matrix = window.getComputedStyle(wheelElement).getPropertyValue('transform');\n      var offsetY = Math.round(+matrix.split(')')[0].split(', ')[5]);\n      setScrollY(offsetY);\n    }\n\n    if (wheelElement) {\n      removeStyle(wheelElement, transitionCSS);\n    }\n\n    if (handleElement) {\n      removeStyle(handleElement, transitionCSS);\n    }\n  }, [scrollbarYRef, setScrollY, tableBodyRef, virtualized]); // Handle the Touch event and initialize it when touchstart is triggered.\n\n  var handleTouchStart = useCallback(function (event) {\n    var _event$touches$ = event.touches[0],\n        pageX = _event$touches$.pageX,\n        pageY = _event$touches$.pageY;\n    touchX.current = pageX;\n    touchY.current = pageY;\n    momentumStartTime.current = new Date().getTime();\n    momentumStartY.current = scrollY.current;\n    isTouching.current = true;\n    onTouchStart === null || onTouchStart === void 0 ? void 0 : onTouchStart(event); // Stop unfinished scrolling when Touch starts.\n\n    stopScroll();\n  }, [onTouchStart, scrollY, stopScroll]); // Handle the Touch event and update the scroll when touchmove is triggered.\n\n  var handleTouchMove = useCallback(function (event) {\n    if (!isTouching.current) {\n      return;\n    }\n\n    var _event$touches$2 = event.touches[0],\n        pageX = _event$touches$2.pageX,\n        pageY = _event$touches$2.pageY;\n    var deltaX = touchX.current - pageX;\n    var deltaY = autoHeight ? 0 : touchY.current - pageY;\n\n    if (!shouldHandleWheelY(deltaY) && !shouldHandleWheelX(deltaX)) {\n      return;\n    }\n    /**\n     * Prevent the default touch event when the table is scrollable.\n     * fix: https://github.com/rsuite/rsuite-table/commit/21785fc18f430519ab5885c44540d9ffc30de366#commitcomment-36236425\n     */\n\n\n    if (!autoHeight && shouldHandleWheelY(deltaY)) {\n      var _event$preventDefault;\n\n      (_event$preventDefault = event.preventDefault) === null || _event$preventDefault === void 0 ? void 0 : _event$preventDefault.call(event);\n    }\n\n    var now = new Date().getTime();\n    onWheel(deltaX, deltaY);\n    touchX.current = pageX;\n    touchY.current = pageY; // Record the offset value and time under the condition of triggering inertial scrolling.\n\n    if (now - momentumStartTime.current > momentumTimeThreshold) {\n      momentumStartY.current = scrollY.current;\n      momentumStartTime.current = now;\n    }\n\n    onTouchMove === null || onTouchMove === void 0 ? void 0 : onTouchMove(event);\n  }, [autoHeight, onWheel, onTouchMove, scrollY, shouldHandleWheelX, shouldHandleWheelY]);\n  var handleTouchEnd = useCallback(function (event) {\n    if (!isTouching.current) {\n      return;\n    }\n\n    isTouching.current = false;\n    var touchDuration = new Date().getTime() - momentumStartTime.current;\n    var absDeltaY = Math.abs(scrollY.current - momentumStartY.current); // Enable inertial sliding.\n\n    if (touchDuration < momentumTimeThreshold && absDeltaY > momentumYThreshold) {\n      var _momentum = momentum(scrollY.current, momentumStartY.current, touchDuration),\n          delta = _momentum.delta,\n          duration = _momentum.duration,\n          bezier = _momentum.bezier;\n\n      onWheel(0, delta, {\n        duration: duration,\n        bezier: bezier\n      });\n      onTouchEnd === null || onTouchEnd === void 0 ? void 0 : onTouchEnd(event);\n    }\n  }, [onWheel, onTouchEnd, scrollY]);\n  /**\n   * When the user uses the tab key in the Table, the onScroll event is triggered,\n   * and the scroll bar position should be updated at the same time.\n   * https://github.com/rsuite/rsuite/issues/234\n   */\n\n  var onScrollBody = useCallback(function (event) {\n    if (event.target !== tableBodyRef.current) {\n      return;\n    }\n\n    var left = scrollLeft(event.target);\n    var top = scrollTop(event.target);\n\n    if (top === 0 && left === 0) {\n      return;\n    }\n\n    onWheel(left, top);\n    scrollLeft(event.target, 0);\n    scrollTop(event.target, 0);\n  }, [onWheel, tableBodyRef]);\n  var getControlledScrollTopValue = useCallback(function (value) {\n    if (autoHeight) {\n      return [0, 0];\n    }\n\n    var height = getTableHeight(); // The maximum range of scrolling value is judged.\n\n    value = Math.min(value, Math.max(0, contentHeight.current - (height - headerHeight))); // The value is a value of the theoretical scroll position of the table,\n    // and the scrollY coordinate value and the value of the scroll bar position are calculated by value.\n\n    return [-value, value / contentHeight.current * (height - headerHeight)];\n  }, [autoHeight, contentHeight, getTableHeight, headerHeight]);\n\n  var rerender = function rerender() {\n    setScrolling(true);\n    defer(function () {\n      if (tableBodyRef.current) {\n        setScrolling(false);\n      }\n    });\n  };\n\n  var getControlledScrollLeftValue = function getControlledScrollLeftValue(value) {\n    // The maximum range of scrolling value is judged.\n    value = Math.min(value, Math.max(0, contentWidth.current - tableWidth.current));\n    return [-value, value / contentWidth.current * tableWidth.current];\n  };\n\n  var onScrollTop = function onScrollTop(top) {\n    var _scrollbarYRef$curren4, _scrollbarYRef$curren5;\n\n    if (top === void 0) {\n      top = 0;\n    }\n\n    var _getControlledScrollT = getControlledScrollTopValue(top),\n        nextScrollY = _getControlledScrollT[0],\n        handleScrollY = _getControlledScrollT[1];\n\n    var height = getTableHeight();\n\n    if (!loading && nextScrollY !== scrollY.current) {\n      onScroll === null || onScroll === void 0 ? void 0 : onScroll(Math.abs(scrollX.current), Math.abs(nextScrollY));\n    }\n\n    setScrollY(nextScrollY);\n    scrollbarYRef === null || scrollbarYRef === void 0 ? void 0 : (_scrollbarYRef$curren4 = scrollbarYRef.current) === null || _scrollbarYRef$curren4 === void 0 ? void 0 : (_scrollbarYRef$curren5 = _scrollbarYRef$curren4.resetScrollBarPosition) === null || _scrollbarYRef$curren5 === void 0 ? void 0 : _scrollbarYRef$curren5.call(_scrollbarYRef$curren4, handleScrollY);\n    deferUpdatePosition();\n    /**\n     * After calling `scrollTop`, a white screen will appear when `virtualized` is true.\n     * The reason is that the coordinates of the DOM are directly manipulated,\n     * but the component is not re-rendered. Need to call `rerender`.\n     * Fix: rsuite#1044\n     */\n\n    if (virtualized && contentHeight.current > height) {\n      rerender();\n    }\n  };\n\n  var onScrollLeft = function onScrollLeft(left) {\n    var _scrollbarXRef$curren3, _scrollbarXRef$curren4;\n\n    if (left === void 0) {\n      left = 0;\n    }\n\n    var _getControlledScrollL = getControlledScrollLeftValue(left),\n        nextScrollX = _getControlledScrollL[0],\n        scrollbarX = _getControlledScrollL[1];\n\n    setScrollX(nextScrollX);\n    !loading && (onScroll === null || onScroll === void 0 ? void 0 : onScroll(Math.abs(nextScrollX), Math.abs(scrollY.current)));\n    scrollbarXRef === null || scrollbarXRef === void 0 ? void 0 : (_scrollbarXRef$curren3 = scrollbarXRef.current) === null || _scrollbarXRef$curren3 === void 0 ? void 0 : (_scrollbarXRef$curren4 = _scrollbarXRef$curren3.resetScrollBarPosition) === null || _scrollbarXRef$curren4 === void 0 ? void 0 : _scrollbarXRef$curren4.call(_scrollbarXRef$curren3, scrollbarX);\n    deferUpdatePosition();\n  };\n\n  var onScrollTo = function onScrollTo(coord) {\n    var _ref = coord || {},\n        x = _ref.x,\n        y = _ref.y;\n\n    if (typeof x === 'number') {\n      onScrollLeft(x);\n    }\n\n    if (typeof y === 'number') {\n      onScrollTop(y);\n    }\n  };\n\n  useUpdateEffect(function () {\n    if (scrollY.current !== 0) {\n      onScrollTop(Math.abs(scrollY.current));\n    } // fix: #405 #404\n\n\n    deferUpdatePosition();\n  }, [height, data]);\n  var releaseListeners = useCallback(function () {\n    var _wheelListener$curren, _touchStartListener$c, _touchMoveListener$cu, _touchEndListener$cur;\n\n    wheelHandler.current = null;\n    (_wheelListener$curren = wheelListener.current) === null || _wheelListener$curren === void 0 ? void 0 : _wheelListener$curren.off();\n    (_touchStartListener$c = touchStartListener.current) === null || _touchStartListener$c === void 0 ? void 0 : _touchStartListener$c.off();\n    (_touchMoveListener$cu = touchMoveListener.current) === null || _touchMoveListener$cu === void 0 ? void 0 : _touchMoveListener$cu.off();\n    (_touchEndListener$cur = touchEndListener.current) === null || _touchEndListener$cur === void 0 ? void 0 : _touchEndListener$cur.off();\n  }, []);\n  useEffect(function () {\n    var options = {\n      passive: false\n    };\n    var tableBody = tableBodyRef.current;\n\n    if (tableBody) {\n      // Reset the listener after props is updated.\n      releaseListeners();\n      wheelHandler.current = new WheelHandler(onWheel, shouldHandleWheelX, shouldHandleWheelY, false);\n      wheelListener.current = on(tableBody, 'wheel', wheelHandler.current.onWheel, options);\n\n      if (isSupportTouchEvent()) {\n        touchStartListener.current = on(tableBody, 'touchstart', handleTouchStart, options);\n        touchMoveListener.current = on(tableBody, 'touchmove', handleTouchMove, options);\n        touchEndListener.current = on(tableBody, 'touchend', handleTouchEnd, options);\n      }\n    }\n\n    return releaseListeners;\n  }, [handleTouchEnd, handleTouchMove, handleTouchStart, onWheel, releaseListeners, shouldHandleWheelX, shouldHandleWheelY, tableBodyRef]);\n  useMount(function () {\n    if (rtl) {\n      var _scrollbarXRef$curren5, _scrollbarXRef$curren6;\n\n      // Initialize scroll position\n      setScrollX(tableWidth.current - contentWidth.current - SCROLLBAR_WIDTH);\n      scrollbarXRef === null || scrollbarXRef === void 0 ? void 0 : (_scrollbarXRef$curren5 = scrollbarXRef.current) === null || _scrollbarXRef$curren5 === void 0 ? void 0 : (_scrollbarXRef$curren6 = _scrollbarXRef$curren5.resetScrollBarPosition) === null || _scrollbarXRef$curren6 === void 0 ? void 0 : _scrollbarXRef$curren6.call(_scrollbarXRef$curren5, -scrollX.current);\n      forceUpdatePosition();\n    }\n  });\n  var onScrollHorizontal = useCallback(function (delta) {\n    return handleWheel(delta, 0);\n  }, [handleWheel]);\n  var onScrollVertical = useCallback(function (delta, event) {\n    return handleWheel(0, delta, undefined, event);\n  }, [handleWheel]);\n  return {\n    isScrolling: isScrolling,\n    onScrollHorizontal: onScrollHorizontal,\n    onScrollVertical: onScrollVertical,\n    onScrollBody: onScrollBody,\n    onScrollTop: onScrollTop,\n    onScrollLeft: onScrollLeft,\n    onScrollTo: onScrollTo\n  };\n};\n\nexport default useScrollListener;"]},"metadata":{},"sourceType":"module"}