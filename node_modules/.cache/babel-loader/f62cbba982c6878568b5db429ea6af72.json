{"ast":null,"code":"import _taggedTemplateLiteralLoose from \"@babel/runtime/helpers/esm/taggedTemplateLiteralLoose\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\n\nvar _templateObject, _templateObject2, _templateObject3, _templateObject4, _templateObject5;\n\nimport React, { useState, useRef, useEffect, useCallback, useContext } from 'react';\nimport PropTypes from 'prop-types';\nimport isUndefined from 'lodash/isUndefined';\nimport isNil from 'lodash/isNil';\nimport isFunction from 'lodash/isFunction';\nimport remove from 'lodash/remove';\nimport clone from 'lodash/clone';\nimport isArray from 'lodash/isArray';\nimport omit from 'lodash/omit';\nimport pick from 'lodash/pick';\nimport getWidth from 'dom-lib/getWidth';\nimport shallowEqual from '../utils/shallowEqual';\nimport { filterNodesOfTree } from '../utils/treeUtils';\nimport Plaintext from '../Plaintext';\nimport { createChainedFunction, tplTransform, useClassNames, useCustom, useControlled, mergeRefs, isOneOf, KEY_VALUES } from '../utils';\nimport { getDataGroupBy } from '../utils/getDataGroupBy';\nimport { DropdownMenu, DropdownMenuItem, DropdownMenuCheckItem, PickerToggle, PickerOverlay, PickerToggleTrigger, useFocusItemValue, usePickerClassName, useSearch, usePublicMethods, useToggleKeyDownEvent, pickTriggerPropKeys, omitTriggerPropKeys, listPickerPropTypes } from '../Picker';\nimport Tag from '../Tag';\nimport InputAutosize from './InputAutosize';\nimport InputSearch from './InputSearch';\nexport var InputPickerContext = /*#__PURE__*/React.createContext({\n  tagProps: {},\n  trigger: 'Enter'\n});\nvar InputPicker = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  var _merge;\n\n  var _props$as = props.as,\n      Component = _props$as === void 0 ? 'div' : _props$as,\n      _props$appearance = props.appearance,\n      appearance = _props$appearance === void 0 ? 'default' : _props$appearance,\n      _props$cleanable = props.cleanable,\n      cleanable = _props$cleanable === void 0 ? true : _props$cleanable,\n      _props$cacheData = props.cacheData,\n      cacheData = _props$cacheData === void 0 ? [] : _props$cacheData,\n      _props$classPrefix = props.classPrefix,\n      classPrefix = _props$classPrefix === void 0 ? 'picker' : _props$classPrefix,\n      _props$data = props.data,\n      controlledData = _props$data === void 0 ? [] : _props$data,\n      disabled = props.disabled,\n      readOnly = props.readOnly,\n      plaintext = props.plaintext,\n      defaultValue = props.defaultValue,\n      _props$defaultOpen = props.defaultOpen,\n      defaultOpen = _props$defaultOpen === void 0 ? false : _props$defaultOpen,\n      _props$disabledItemVa = props.disabledItemValues,\n      disabledItemValues = _props$disabledItemVa === void 0 ? [] : _props$disabledItemVa,\n      overrideLocale = props.locale,\n      toggleAs = props.toggleAs,\n      style = props.style,\n      _props$searchable = props.searchable,\n      searchable = _props$searchable === void 0 ? true : _props$searchable,\n      controlledOpen = props.open,\n      placeholder = props.placeholder,\n      groupBy = props.groupBy,\n      menuClassName = props.menuClassName,\n      menuStyle = props.menuStyle,\n      _props$menuAutoWidth = props.menuAutoWidth,\n      menuAutoWidth = _props$menuAutoWidth === void 0 ? true : _props$menuAutoWidth,\n      _props$menuMaxHeight = props.menuMaxHeight,\n      menuMaxHeight = _props$menuMaxHeight === void 0 ? 320 : _props$menuMaxHeight,\n      creatable = props.creatable,\n      shouldDisplayCreateOption = props.shouldDisplayCreateOption,\n      valueProp = props.value,\n      _props$valueKey = props.valueKey,\n      valueKey = _props$valueKey === void 0 ? 'value' : _props$valueKey,\n      virtualized = props.virtualized,\n      _props$labelKey = props.labelKey,\n      labelKey = _props$labelKey === void 0 ? 'label' : _props$labelKey,\n      listProps = props.listProps,\n      id = props.id,\n      tabIndex = props.tabIndex,\n      sort = props.sort,\n      renderMenu = props.renderMenu,\n      renderExtraFooter = props.renderExtraFooter,\n      renderValue = props.renderValue,\n      renderMenuItem = props.renderMenuItem,\n      renderMenuGroup = props.renderMenuGroup,\n      onEnter = props.onEnter,\n      onEntered = props.onEntered,\n      onExit = props.onExit,\n      onExited = props.onExited,\n      onChange = props.onChange,\n      onClean = props.onClean,\n      onCreate = props.onCreate,\n      onSearch = props.onSearch,\n      onSelect = props.onSelect,\n      onOpen = props.onOpen,\n      onClose = props.onClose,\n      onBlur = props.onBlur,\n      onFocus = props.onFocus,\n      searchBy = props.searchBy,\n      _props$placement = props.placement,\n      placement = _props$placement === void 0 ? 'bottomStart' : _props$placement,\n      rest = _objectWithoutPropertiesLoose(props, [\"as\", \"appearance\", \"cleanable\", \"cacheData\", \"classPrefix\", \"data\", \"disabled\", \"readOnly\", \"plaintext\", \"defaultValue\", \"defaultOpen\", \"disabledItemValues\", \"locale\", \"toggleAs\", \"style\", \"searchable\", \"open\", \"placeholder\", \"groupBy\", \"menuClassName\", \"menuStyle\", \"menuAutoWidth\", \"menuMaxHeight\", \"creatable\", \"shouldDisplayCreateOption\", \"value\", \"valueKey\", \"virtualized\", \"labelKey\", \"listProps\", \"id\", \"tabIndex\", \"sort\", \"renderMenu\", \"renderExtraFooter\", \"renderValue\", \"renderMenuItem\", \"renderMenuGroup\", \"onEnter\", \"onEntered\", \"onExit\", \"onExited\", \"onChange\", \"onClean\", \"onCreate\", \"onSearch\", \"onSelect\", \"onOpen\", \"onClose\", \"onBlur\", \"onFocus\", \"searchBy\", \"placement\"]);\n\n  var _useContext = useContext(InputPickerContext),\n      multi = _useContext.multi,\n      tagProps = _useContext.tagProps,\n      trigger = _useContext.trigger,\n      disabledOptions = _useContext.disabledOptions;\n\n  if (groupBy === valueKey || groupBy === labelKey) {\n    throw Error('`groupBy` can not be equal to `valueKey` and `labelKey`');\n  }\n\n  var overlayRef = useRef(null);\n  var targetRef = useRef(null);\n  var triggerRef = useRef(null);\n  var inputRef = useRef();\n  var listRef = useRef(null);\n\n  var _useCustom = useCustom(['Picker', 'InputPicker'], overrideLocale),\n      locale = _useCustom.locale;\n\n  var _useClassNames = useClassNames(classPrefix),\n      prefix = _useClassNames.prefix,\n      merge = _useClassNames.merge;\n\n  var _useState = useState(controlledData),\n      uncontrolledData = _useState[0],\n      setData = _useState[1];\n\n  var _useState2 = useState(100),\n      maxWidth = _useState2[0],\n      setMaxWidth = _useState2[1];\n\n  var _useState3 = useState([]),\n      newData = _useState3[0],\n      setNewData = _useState3[1];\n\n  var _useState4 = useState(defaultOpen),\n      uncontrolledOpen = _useState4[0],\n      setOpen = _useState4[1];\n\n  var open = isUndefined(controlledOpen) ? uncontrolledOpen : controlledOpen;\n  var getAllData = useCallback(function () {\n    return [].concat(uncontrolledData, newData);\n  }, [uncontrolledData, newData]);\n  var getAllDataAndCache = useCallback(function () {\n    return [].concat(getAllData(), cacheData);\n  }, [getAllData, cacheData]);\n\n  var _useControlled = useControlled(valueProp, multi ? defaultValue || [] : defaultValue),\n      value = _useControlled[0],\n      setValue = _useControlled[1],\n      isControlled = _useControlled[2];\n\n  var cloneValue = useCallback(function () {\n    return multi ? clone(value) || [] : value;\n  }, [multi, value]);\n  var handleClose = useCallback(function () {\n    var _triggerRef$current;\n\n    triggerRef === null || triggerRef === void 0 ? void 0 : (_triggerRef$current = triggerRef.current) === null || _triggerRef$current === void 0 ? void 0 : _triggerRef$current.close();\n  }, [triggerRef]); // Used to hover the focuse item  when trigger `onKeydown`\n\n  var _useFocusItemValue = useFocusItemValue(multi ? value === null || value === void 0 ? void 0 : value[0] : value, {\n    data: getAllDataAndCache(),\n    valueKey: valueKey,\n    target: function target() {\n      return overlayRef.current;\n    }\n  }),\n      focusItemValue = _useFocusItemValue.focusItemValue,\n      setFocusItemValue = _useFocusItemValue.setFocusItemValue,\n      onKeyDown = _useFocusItemValue.onKeyDown;\n\n  var handleSearchCallback = useCallback(function (searchKeyword, filteredData, event) {\n    var _filteredData$; // The first option after filtering is the focus.\n\n\n    setFocusItemValue(disabledOptions ? searchKeyword : (filteredData === null || filteredData === void 0 ? void 0 : (_filteredData$ = filteredData[0]) === null || _filteredData$ === void 0 ? void 0 : _filteredData$[valueKey]) || searchKeyword);\n    onSearch === null || onSearch === void 0 ? void 0 : onSearch(searchKeyword, event);\n  }, [disabledOptions, setFocusItemValue, valueKey, onSearch]); // Use search keywords to filter options.\n\n  var _useSearch = useSearch(getAllData(), {\n    labelKey: labelKey,\n    searchBy: searchBy,\n    callback: handleSearchCallback\n  }),\n      searchKeyword = _useSearch.searchKeyword,\n      resetSearch = _useSearch.resetSearch,\n      checkShouldDisplay = _useSearch.checkShouldDisplay,\n      handleSearch = _useSearch.handleSearch; // Update the state when the data in props changes\n\n\n  useEffect(function () {\n    if (controlledData && !shallowEqual(controlledData, uncontrolledData)) {\n      var _controlledData$;\n\n      setData(controlledData);\n      setNewData([]);\n      setFocusItemValue(controlledData === null || controlledData === void 0 ? void 0 : (_controlledData$ = controlledData[0]) === null || _controlledData$ === void 0 ? void 0 : _controlledData$[valueKey]);\n    }\n  }, [setFocusItemValue, controlledData, uncontrolledData, valueKey]);\n  useEffect(function () {\n    var _triggerRef$current2; // In multiple selection, you need to set a maximum width for the input.\n\n\n    if ((_triggerRef$current2 = triggerRef.current) !== null && _triggerRef$current2 !== void 0 && _triggerRef$current2.root) {\n      setMaxWidth(getWidth(triggerRef.current.root));\n    }\n  }, []); // Update the position of the menu when the search keyword and value change\n\n  useEffect(function () {\n    var _triggerRef$current3, _triggerRef$current3$;\n\n    (_triggerRef$current3 = triggerRef.current) === null || _triggerRef$current3 === void 0 ? void 0 : (_triggerRef$current3$ = _triggerRef$current3.updatePosition) === null || _triggerRef$current3$ === void 0 ? void 0 : _triggerRef$current3$.call(_triggerRef$current3);\n  }, [searchKeyword, value]);\n\n  var getDateItem = function getDateItem(value) {\n    // Find active `MenuItem` by `value`\n    var allData = getAllDataAndCache();\n    var activeItem = allData.find(function (item) {\n      return shallowEqual(item[valueKey], value);\n    });\n    var itemNode = placeholder;\n\n    if (activeItem !== null && activeItem !== void 0 && activeItem[labelKey]) {\n      itemNode = activeItem === null || activeItem === void 0 ? void 0 : activeItem[labelKey];\n    }\n\n    return {\n      isValid: !!activeItem,\n      activeItem: activeItem,\n      itemNode: itemNode\n    };\n  };\n\n  var getInput = useCallback(function () {\n    var _inputRef$current;\n\n    return multi ? (_inputRef$current = inputRef.current) === null || _inputRef$current === void 0 ? void 0 : _inputRef$current.input : inputRef.current;\n  }, [inputRef, multi]);\n  var focusInput = useCallback(function () {\n    var _getInput;\n\n    return (_getInput = getInput()) === null || _getInput === void 0 ? void 0 : _getInput.focus();\n  }, [getInput]);\n  var blurInput = useCallback(function () {\n    var _getInput2;\n\n    return (_getInput2 = getInput()) === null || _getInput2 === void 0 ? void 0 : _getInput2.blur();\n  }, [getInput]);\n  /**\n   * Convert the string of the newly created option into an object.\n   */\n\n  var createOption = useCallback(function (value) {\n    var _ref2;\n\n    if (groupBy) {\n      var _ref;\n\n      return _ref = {\n        create: true\n      }, _ref[groupBy] = locale === null || locale === void 0 ? void 0 : locale.newItem, _ref[valueKey] = value, _ref[labelKey] = value, _ref;\n    }\n\n    return _ref2 = {\n      create: true\n    }, _ref2[valueKey] = value, _ref2[labelKey] = value, _ref2;\n  }, [groupBy, valueKey, labelKey, locale]);\n  var handleChange = useCallback(function (value, event) {\n    onChange === null || onChange === void 0 ? void 0 : onChange(value, event);\n  }, [onChange]);\n  var handleRemoveItemByTag = useCallback(function (tag, event) {\n    event.stopPropagation();\n    var val = cloneValue();\n    remove(val, function (itemVal) {\n      return shallowEqual(itemVal, tag);\n    });\n    setValue(val);\n    handleChange(val, event);\n  }, [setValue, cloneValue, handleChange]);\n  var handleSelect = useCallback(function (value, item, event) {\n    onSelect === null || onSelect === void 0 ? void 0 : onSelect(value, item, event);\n\n    if (creatable && item.create) {\n      delete item.create;\n      onCreate === null || onCreate === void 0 ? void 0 : onCreate(value, item, event);\n      setNewData(newData.concat(item));\n    }\n  }, [creatable, newData, onSelect, onCreate]);\n  /**\n   * Callback triggered by single selection\n   * @param value\n   * @param item\n   * @param event\n   */\n\n  var handleSelectItem = function handleSelectItem(value, item, event) {\n    setValue(value);\n    setFocusItemValue(value);\n    resetSearch();\n    handleSelect(value, item, event);\n    handleChange(value, event);\n    handleClose();\n  };\n  /**\n   * Callback triggered by multiple selection\n   * @param nextItemValue\n   * @param item\n   * @param event\n   * @param checked\n   */\n\n\n  var handleCheckTag = function handleCheckTag(nextItemValue, item, event, checked) {\n    var val = cloneValue();\n\n    if (checked) {\n      val.push(nextItemValue);\n    } else {\n      remove(val, function (itemVal) {\n        return shallowEqual(itemVal, nextItemValue);\n      });\n    }\n\n    setValue(val);\n    resetSearch();\n    setFocusItemValue(nextItemValue);\n    handleSelect(val, item, event);\n    handleChange(val, event);\n    focusInput();\n  };\n\n  var handleTagKeyPress = useCallback(function (event) {\n    // When composing, ignore the keypress event.\n    if (event.nativeEvent.isComposing) {\n      return;\n    }\n\n    var val = cloneValue();\n    var data = getAllData();\n\n    if (!focusItemValue || !data) {\n      return;\n    } // If the value is disabled in this option, it is returned.\n\n\n    if (disabledItemValues !== null && disabledItemValues !== void 0 && disabledItemValues.some(function (item) {\n      return item === focusItemValue;\n    })) {\n      return;\n    }\n\n    if (!val.some(function (v) {\n      return shallowEqual(v, focusItemValue);\n    })) {\n      val.push(focusItemValue);\n    } else if (!disabledOptions) {\n      remove(val, function (itemVal) {\n        return shallowEqual(itemVal, focusItemValue);\n      });\n    }\n\n    var focusItem = data.find(function (item) {\n      return shallowEqual(item === null || item === void 0 ? void 0 : item[valueKey], focusItemValue);\n    });\n\n    if (!focusItem) {\n      focusItem = createOption(focusItemValue);\n    }\n\n    setValue(val);\n    resetSearch();\n    handleSelect(val, focusItem, event);\n    handleChange(val, event);\n  }, [cloneValue, getAllData, focusItemValue, disabledItemValues, disabledOptions, setValue, resetSearch, handleSelect, handleChange, valueKey, createOption]);\n  var handleMenuItemKeyPress = useCallback(function (event) {\n    if (!focusItemValue || !controlledData) {\n      return;\n    } // If the value is disabled in this option, it is returned.\n\n\n    if (disabledItemValues !== null && disabledItemValues !== void 0 && disabledItemValues.some(function (item) {\n      return item === focusItemValue;\n    })) {\n      return;\n    } // Find active `MenuItem` by `value`\n\n\n    var allData = getAllData();\n    var focusItem = allData.find(function (item) {\n      return shallowEqual(item[valueKey], focusItemValue);\n    }); // FIXME Bad state flow\n\n    if (!focusItem && focusItemValue === searchKeyword) {\n      focusItem = createOption(searchKeyword);\n    }\n\n    setValue(focusItemValue);\n    resetSearch();\n\n    if (focusItem) {\n      handleSelect(focusItemValue, focusItem, event);\n    }\n\n    handleChange(focusItemValue, event);\n    handleClose();\n  }, [setValue, disabledItemValues, controlledData, focusItemValue, valueKey, searchKeyword, handleClose, resetSearch, createOption, getAllData, handleChange, handleSelect]);\n  usePublicMethods(ref, {\n    triggerRef: triggerRef,\n    overlayRef: overlayRef,\n    targetRef: targetRef,\n    listRef: listRef\n  });\n  /**\n   * Remove the last item, after pressing the back key on the keyboard.\n   * @param event\n   */\n\n  var removeLastItem = useCallback(function (event) {\n    var target = event === null || event === void 0 ? void 0 : event.target;\n\n    if ((target === null || target === void 0 ? void 0 : target.tagName) !== 'INPUT') {\n      focusInput();\n      return;\n    }\n\n    if ((target === null || target === void 0 ? void 0 : target.tagName) === 'INPUT' && target !== null && target !== void 0 && target.value) {\n      return;\n    }\n\n    var val = cloneValue();\n    val.pop();\n    setValue(val);\n    handleChange(val, event);\n  }, [setValue, focusInput, handleChange, cloneValue]);\n  var handleClean = useCallback(function (event) {\n    if (disabled || searchKeyword !== '') {\n      return;\n    }\n\n    setValue(null);\n    setFocusItemValue(null);\n    resetSearch();\n\n    if (multi) {\n      handleChange([], event);\n    } else {\n      handleChange(null, event);\n    }\n\n    onClean === null || onClean === void 0 ? void 0 : onClean(event);\n  }, [disabled, searchKeyword, setValue, setFocusItemValue, resetSearch, multi, onClean, handleChange]);\n  var events = {\n    onMenuPressBackspace: multi ? removeLastItem : handleClean,\n    onMenuKeyDown: onKeyDown,\n    onMenuPressEnter: undefined,\n    onKeyDown: undefined\n  };\n  var handleKeyPress = useCallback(function (event) {\n    // When typing a space, create a tag.\n    if (isOneOf('Space', trigger) && event.key === KEY_VALUES.SPACE) {\n      handleTagKeyPress(event);\n      event.preventDefault();\n    } // When typing a comma, create a tag.\n\n\n    if (isOneOf('Comma', trigger) && event.key === KEY_VALUES.COMMA) {\n      handleTagKeyPress(event);\n      event.preventDefault();\n    }\n  }, [handleTagKeyPress, trigger]);\n\n  if (multi) {\n    if (isOneOf('Enter', trigger)) {\n      events.onMenuPressEnter = handleTagKeyPress;\n    }\n\n    if (creatable) {\n      events.onKeyDown = handleKeyPress;\n    }\n  } else {\n    events.onMenuPressEnter = handleMenuItemKeyPress;\n  }\n\n  var onPickerKeyDown = useToggleKeyDownEvent(_extends({\n    triggerRef: triggerRef,\n    targetRef: targetRef,\n    overlayRef: overlayRef\n  }, events, rest));\n  var handleExited = useCallback(function () {\n    setFocusItemValue(multi ? value === null || value === void 0 ? void 0 : value[0] : value);\n    resetSearch();\n    onClose === null || onClose === void 0 ? void 0 : onClose();\n  }, [setFocusItemValue, resetSearch, onClose, value, multi]);\n  var handleFocus = useCallback(function () {\n    if (!readOnly) {\n      var _triggerRef$current4;\n\n      setOpen(true);\n      (_triggerRef$current4 = triggerRef.current) === null || _triggerRef$current4 === void 0 ? void 0 : _triggerRef$current4.open();\n    }\n  }, [readOnly]);\n  var handleBlur = useCallback(function () {\n    setOpen(false);\n  }, []);\n  var handleEnter = useCallback(function () {\n    focusInput();\n    setOpen(true);\n  }, [focusInput]);\n  var handleExit = useCallback(function () {\n    blurInput();\n    setOpen(false);\n  }, [blurInput]);\n\n  var renderDropdownMenuItem = function renderDropdownMenuItem(label, item) {\n    // 'Create option \"{0}\"' =>  Create option \"xxxxx\"\n    var newLabel = item.create ? /*#__PURE__*/React.createElement(\"span\", null, tplTransform(locale.createOption, label)) : label;\n    return renderMenuItem ? renderMenuItem(newLabel, item) : newLabel;\n  };\n\n  var checkValue = function checkValue() {\n    if (multi) {\n      return {\n        isValid: false,\n        itemNode: null\n      };\n    }\n\n    var dataItem = getDateItem(value);\n    var itemNode = dataItem.itemNode;\n\n    if (!isNil(value) && isFunction(renderValue)) {\n      itemNode = renderValue(value, dataItem.activeItem, itemNode);\n    }\n\n    return {\n      isValid: dataItem.isValid,\n      itemNode: itemNode\n    };\n  };\n\n  var renderMultiValue = function renderMultiValue() {\n    if (!multi) {\n      return null;\n    }\n\n    var _tagProps$closable = tagProps.closable,\n        closable = _tagProps$closable === void 0 ? true : _tagProps$closable,\n        onClose = tagProps.onClose,\n        tagRest = _objectWithoutPropertiesLoose(tagProps, [\"closable\", \"onClose\"]);\n\n    var tags = value || [];\n    var items = [];\n    var tagElements = tags.map(function (tag) {\n      var _getDateItem = getDateItem(tag),\n          isValid = _getDateItem.isValid,\n          itemNode = _getDateItem.itemNode,\n          activeItem = _getDateItem.activeItem;\n\n      items.push(activeItem);\n\n      if (!isValid) {\n        return null;\n      }\n\n      return /*#__PURE__*/React.createElement(Tag, _extends({}, tagRest, {\n        key: tag,\n        size: rest.size === 'lg' ? 'lg' : rest.size === 'xs' ? 'sm' : 'md',\n        closable: !disabled && closable && !readOnly && !plaintext,\n        title: typeof itemNode === 'string' ? itemNode : undefined,\n        onClose: createChainedFunction(handleRemoveItemByTag.bind(null, tag), onClose)\n      }), itemNode);\n    }).filter(function (item) {\n      return item !== null;\n    });\n\n    if ((tags.length > 0 || isControlled) && isFunction(renderValue)) {\n      return renderValue(value, items, tagElements);\n    }\n\n    return tagElements;\n  };\n\n  var renderDropdownMenu = function renderDropdownMenu(positionProps, speakerRef) {\n    var left = positionProps.left,\n        top = positionProps.top,\n        className = positionProps.className;\n    var menuClassPrefix = multi ? 'picker-check-menu' : 'picker-select-menu';\n    var classes = merge(className, menuClassName, prefix(multi ? 'check-menu' : 'select-menu'));\n\n    var styles = _extends({}, menuStyle, {\n      left: left,\n      top: top\n    });\n\n    var items = filterNodesOfTree(getAllData(), checkShouldDisplay);\n\n    if (creatable && (typeof shouldDisplayCreateOption === 'function' ? shouldDisplayCreateOption(searchKeyword, items) : searchKeyword && !items.find(function (item) {\n      return item[valueKey] === searchKeyword;\n    }))) {\n      items = [].concat(items, [createOption(searchKeyword)]);\n    } // Create a tree structure data when set `groupBy`\n\n\n    if (groupBy) {\n      items = getDataGroupBy(items, groupBy, sort);\n    } else if (typeof sort === 'function') {\n      items = items.sort(sort(false));\n    }\n\n    if (disabledOptions) {\n      return /*#__PURE__*/React.createElement(PickerOverlay, {\n        ref: mergeRefs(overlayRef, speakerRef)\n      });\n    }\n\n    var menu = items.length ? /*#__PURE__*/React.createElement(DropdownMenu, {\n      id: id ? id + \"-listbox\" : undefined,\n      listProps: listProps,\n      listRef: listRef,\n      disabledItemValues: disabledItemValues,\n      valueKey: valueKey,\n      labelKey: labelKey,\n      classPrefix: menuClassPrefix,\n      dropdownMenuItemClassPrefix: multi ? undefined : menuClassPrefix + \"-item\",\n      dropdownMenuItemAs: multi ? DropdownMenuCheckItem : DropdownMenuItem,\n      activeItemValues: multi ? value : [value],\n      focusItemValue: focusItemValue,\n      maxHeight: menuMaxHeight,\n      data: items // FIXME-Doma\n      // `group` is redundant so long as `groupBy` exists\n      ,\n      group: !isUndefined(groupBy),\n      groupBy: groupBy,\n      onSelect: multi ? handleCheckTag : handleSelectItem // fixme don't use any\n      ,\n      renderMenuGroup: renderMenuGroup,\n      renderMenuItem: renderDropdownMenuItem,\n      virtualized: virtualized\n    }) : /*#__PURE__*/React.createElement(\"div\", {\n      className: prefix(_templateObject || (_templateObject = _taggedTemplateLiteralLoose([\"none\"])))\n    }, locale === null || locale === void 0 ? void 0 : locale.noResultsText);\n    return /*#__PURE__*/React.createElement(PickerOverlay, {\n      ref: mergeRefs(overlayRef, speakerRef),\n      autoWidth: menuAutoWidth,\n      className: classes,\n      style: styles,\n      target: triggerRef,\n      onKeyDown: onPickerKeyDown\n    }, renderMenu ? renderMenu(menu) : menu, renderExtraFooter === null || renderExtraFooter === void 0 ? void 0 : renderExtraFooter());\n  };\n\n  var _checkValue = checkValue(),\n      isValid = _checkValue.isValid,\n      itemNode = _checkValue.itemNode;\n\n  var tagElements = renderMultiValue();\n  /**\n   * 1.Have a value and the value is valid.\n   * 2.Regardless of whether the value is valid, as long as renderValue is set, it is judged to have a value.\n   * 3.If renderValue returns null or undefined, hasValue is false.\n   */\n\n  var hasSingleValue = !isNil(value) && isFunction(renderValue) && !isNil(itemNode);\n  var hasMultiValue = isArray(value) && value.length > 0 && isFunction(renderValue) && !isNil(tagElements);\n  var hasValue = multi ? !!(tagElements !== null && tagElements !== void 0 && tagElements.length) || hasMultiValue : isValid || hasSingleValue;\n\n  var _usePickerClassName = usePickerClassName(_extends({}, props, {\n    classPrefix: classPrefix,\n    appearance: appearance,\n    hasValue: hasValue,\n    name: 'input',\n    cleanable: cleanable\n  })),\n      pickerClasses = _usePickerClassName[0],\n      usedClassNamePropKeys = _usePickerClassName[1];\n\n  var classes = merge(pickerClasses, (_merge = {}, _merge[prefix(_templateObject2 || (_templateObject2 = _taggedTemplateLiteralLoose([\"tag\"])))] = multi, _merge[prefix(_templateObject3 || (_templateObject3 = _taggedTemplateLiteralLoose([\"focused\"])))] = open, _merge[prefix(_templateObject4 || (_templateObject4 = _taggedTemplateLiteralLoose([\"disabled-options\"])))] = disabledOptions, _merge));\n  var searching = !!searchKeyword && open;\n  var displaySearchInput = searchable && !disabled;\n  var inputProps = multi ? {\n    inputStyle: {\n      maxWidth: maxWidth - 63\n    },\n    as: InputAutosize\n  } : {\n    as: 'input'\n  };\n\n  if (plaintext) {\n    var plaintextProps = {}; // TagPicker has -6px margin-left on the plaintext wrapper\n    // for fixing margin-left on tags from 2nd line on\n\n    if (multi && hasValue) {\n      plaintextProps.style = {\n        marginLeft: -6\n      };\n    }\n\n    return /*#__PURE__*/React.createElement(Plaintext, _extends({\n      localeKey: \"notSelected\",\n      ref: targetRef\n    }, plaintextProps), itemNode || (tagElements !== null && tagElements !== void 0 && tagElements.length ? tagElements : null) || placeholder);\n  }\n\n  var placeholderNode = placeholder || (disabledOptions ? null : locale === null || locale === void 0 ? void 0 : locale.placeholder);\n  return /*#__PURE__*/React.createElement(PickerToggleTrigger, {\n    pickerProps: pick(props, pickTriggerPropKeys),\n    ref: triggerRef,\n    trigger: \"active\",\n    onEnter: createChainedFunction(handleEnter, onEnter),\n    onEntered: createChainedFunction(onEntered, onOpen),\n    onExit: createChainedFunction(handleExit, onExit),\n    onExited: createChainedFunction(handleExited, onExited),\n    speaker: renderDropdownMenu,\n    placement: placement\n  }, /*#__PURE__*/React.createElement(Component, {\n    className: classes,\n    style: style,\n    onClick: focusInput,\n    onKeyDown: onPickerKeyDown\n  }, /*#__PURE__*/React.createElement(PickerToggle, _extends({}, omit(rest, [].concat(omitTriggerPropKeys, usedClassNamePropKeys)), {\n    id: id,\n    appearance: appearance,\n    readOnly: readOnly,\n    plaintext: plaintext,\n    ref: targetRef,\n    as: toggleAs,\n    tabIndex: undefined,\n    onClean: handleClean,\n    cleanable: cleanable && !disabled,\n    hasValue: hasValue,\n    active: open,\n    disabled: disabled,\n    placement: placement,\n    inputValue: value,\n    caret: !disabledOptions\n  }), searching || multi && hasValue ? null : itemNode || placeholderNode), !(!multi && disabled) && /*#__PURE__*/React.createElement(\"div\", {\n    className: prefix(_templateObject5 || (_templateObject5 = _taggedTemplateLiteralLoose([\"tag-wrapper\"])))\n  }, tagElements, displaySearchInput && /*#__PURE__*/React.createElement(InputSearch, _extends({}, inputProps, {\n    tabIndex: tabIndex,\n    readOnly: readOnly,\n    onBlur: createChainedFunction(handleBlur, onBlur),\n    onFocus: createChainedFunction(handleFocus, onFocus),\n    inputRef: inputRef,\n    onChange: handleSearch,\n    value: open ? searchKeyword : ''\n  })))));\n});\nInputPicker.displayName = 'InputPicker';\nInputPicker.propTypes = _extends({}, listPickerPropTypes, {\n  locale: PropTypes.any,\n  appearance: PropTypes.oneOf(['default', 'subtle']),\n  cacheData: PropTypes.array,\n  menuAutoWidth: PropTypes.bool,\n  menuMaxHeight: PropTypes.number,\n  searchable: PropTypes.bool,\n  creatable: PropTypes.bool,\n  groupBy: PropTypes.any,\n  sort: PropTypes.func,\n  renderMenu: PropTypes.func,\n  renderMenuItem: PropTypes.func,\n  renderMenuGroup: PropTypes.func,\n  onCreate: PropTypes.func,\n  onSelect: PropTypes.func,\n  onGroupTitleClick: PropTypes.func,\n  onSearch: PropTypes.func,\n  virtualized: PropTypes.bool,\n  searchBy: PropTypes.func\n});\nexport default InputPicker;","map":{"version":3,"sources":["/Users/danilnagovicyn/Desktop/reactprojects/Incubator/Samurai_way/samurai-way/node_modules/rsuite/esm/InputPicker/InputPicker.js"],"names":["_taggedTemplateLiteralLoose","_extends","_objectWithoutPropertiesLoose","_templateObject","_templateObject2","_templateObject3","_templateObject4","_templateObject5","React","useState","useRef","useEffect","useCallback","useContext","PropTypes","isUndefined","isNil","isFunction","remove","clone","isArray","omit","pick","getWidth","shallowEqual","filterNodesOfTree","Plaintext","createChainedFunction","tplTransform","useClassNames","useCustom","useControlled","mergeRefs","isOneOf","KEY_VALUES","getDataGroupBy","DropdownMenu","DropdownMenuItem","DropdownMenuCheckItem","PickerToggle","PickerOverlay","PickerToggleTrigger","useFocusItemValue","usePickerClassName","useSearch","usePublicMethods","useToggleKeyDownEvent","pickTriggerPropKeys","omitTriggerPropKeys","listPickerPropTypes","Tag","InputAutosize","InputSearch","InputPickerContext","createContext","tagProps","trigger","InputPicker","forwardRef","props","ref","_merge","_props$as","as","Component","_props$appearance","appearance","_props$cleanable","cleanable","_props$cacheData","cacheData","_props$classPrefix","classPrefix","_props$data","data","controlledData","disabled","readOnly","plaintext","defaultValue","_props$defaultOpen","defaultOpen","_props$disabledItemVa","disabledItemValues","overrideLocale","locale","toggleAs","style","_props$searchable","searchable","controlledOpen","open","placeholder","groupBy","menuClassName","menuStyle","_props$menuAutoWidth","menuAutoWidth","_props$menuMaxHeight","menuMaxHeight","creatable","shouldDisplayCreateOption","valueProp","value","_props$valueKey","valueKey","virtualized","_props$labelKey","labelKey","listProps","id","tabIndex","sort","renderMenu","renderExtraFooter","renderValue","renderMenuItem","renderMenuGroup","onEnter","onEntered","onExit","onExited","onChange","onClean","onCreate","onSearch","onSelect","onOpen","onClose","onBlur","onFocus","searchBy","_props$placement","placement","rest","_useContext","multi","disabledOptions","Error","overlayRef","targetRef","triggerRef","inputRef","listRef","_useCustom","_useClassNames","prefix","merge","_useState","uncontrolledData","setData","_useState2","maxWidth","setMaxWidth","_useState3","newData","setNewData","_useState4","uncontrolledOpen","setOpen","getAllData","concat","getAllDataAndCache","_useControlled","setValue","isControlled","cloneValue","handleClose","_triggerRef$current","current","close","_useFocusItemValue","target","focusItemValue","setFocusItemValue","onKeyDown","handleSearchCallback","searchKeyword","filteredData","event","_filteredData$","_useSearch","callback","resetSearch","checkShouldDisplay","handleSearch","_controlledData$","_triggerRef$current2","root","_triggerRef$current3","_triggerRef$current3$","updatePosition","call","getDateItem","allData","activeItem","find","item","itemNode","isValid","getInput","_inputRef$current","input","focusInput","_getInput","focus","blurInput","_getInput2","blur","createOption","_ref2","_ref","create","newItem","handleChange","handleRemoveItemByTag","tag","stopPropagation","val","itemVal","handleSelect","handleSelectItem","handleCheckTag","nextItemValue","checked","push","handleTagKeyPress","nativeEvent","isComposing","some","v","focusItem","handleMenuItemKeyPress","removeLastItem","tagName","pop","handleClean","events","onMenuPressBackspace","onMenuKeyDown","onMenuPressEnter","undefined","handleKeyPress","key","SPACE","preventDefault","COMMA","onPickerKeyDown","handleExited","handleFocus","_triggerRef$current4","handleBlur","handleEnter","handleExit","renderDropdownMenuItem","label","newLabel","createElement","checkValue","dataItem","renderMultiValue","_tagProps$closable","closable","tagRest","tags","items","tagElements","map","_getDateItem","size","title","bind","filter","length","renderDropdownMenu","positionProps","speakerRef","left","top","className","menuClassPrefix","classes","styles","menu","dropdownMenuItemClassPrefix","dropdownMenuItemAs","activeItemValues","maxHeight","group","noResultsText","autoWidth","_checkValue","hasSingleValue","hasMultiValue","hasValue","_usePickerClassName","name","pickerClasses","usedClassNamePropKeys","searching","displaySearchInput","inputProps","inputStyle","plaintextProps","marginLeft","localeKey","placeholderNode","pickerProps","speaker","onClick","active","inputValue","caret","displayName","propTypes","any","oneOf","array","bool","number","func","onGroupTitleClick"],"mappings":"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","sourcesContent":["import _taggedTemplateLiteralLoose from \"@babel/runtime/helpers/esm/taggedTemplateLiteralLoose\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\n\nvar _templateObject, _templateObject2, _templateObject3, _templateObject4, _templateObject5;\n\nimport React, { useState, useRef, useEffect, useCallback, useContext } from 'react';\nimport PropTypes from 'prop-types';\nimport isUndefined from 'lodash/isUndefined';\nimport isNil from 'lodash/isNil';\nimport isFunction from 'lodash/isFunction';\nimport remove from 'lodash/remove';\nimport clone from 'lodash/clone';\nimport isArray from 'lodash/isArray';\nimport omit from 'lodash/omit';\nimport pick from 'lodash/pick';\nimport getWidth from 'dom-lib/getWidth';\nimport shallowEqual from '../utils/shallowEqual';\nimport { filterNodesOfTree } from '../utils/treeUtils';\nimport Plaintext from '../Plaintext';\nimport { createChainedFunction, tplTransform, useClassNames, useCustom, useControlled, mergeRefs, isOneOf, KEY_VALUES } from '../utils';\nimport { getDataGroupBy } from '../utils/getDataGroupBy';\nimport { DropdownMenu, DropdownMenuItem, DropdownMenuCheckItem, PickerToggle, PickerOverlay, PickerToggleTrigger, useFocusItemValue, usePickerClassName, useSearch, usePublicMethods, useToggleKeyDownEvent, pickTriggerPropKeys, omitTriggerPropKeys, listPickerPropTypes } from '../Picker';\nimport Tag from '../Tag';\nimport InputAutosize from './InputAutosize';\nimport InputSearch from './InputSearch';\nexport var InputPickerContext = /*#__PURE__*/React.createContext({\n  tagProps: {},\n  trigger: 'Enter'\n});\nvar InputPicker = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  var _merge;\n\n  var _props$as = props.as,\n      Component = _props$as === void 0 ? 'div' : _props$as,\n      _props$appearance = props.appearance,\n      appearance = _props$appearance === void 0 ? 'default' : _props$appearance,\n      _props$cleanable = props.cleanable,\n      cleanable = _props$cleanable === void 0 ? true : _props$cleanable,\n      _props$cacheData = props.cacheData,\n      cacheData = _props$cacheData === void 0 ? [] : _props$cacheData,\n      _props$classPrefix = props.classPrefix,\n      classPrefix = _props$classPrefix === void 0 ? 'picker' : _props$classPrefix,\n      _props$data = props.data,\n      controlledData = _props$data === void 0 ? [] : _props$data,\n      disabled = props.disabled,\n      readOnly = props.readOnly,\n      plaintext = props.plaintext,\n      defaultValue = props.defaultValue,\n      _props$defaultOpen = props.defaultOpen,\n      defaultOpen = _props$defaultOpen === void 0 ? false : _props$defaultOpen,\n      _props$disabledItemVa = props.disabledItemValues,\n      disabledItemValues = _props$disabledItemVa === void 0 ? [] : _props$disabledItemVa,\n      overrideLocale = props.locale,\n      toggleAs = props.toggleAs,\n      style = props.style,\n      _props$searchable = props.searchable,\n      searchable = _props$searchable === void 0 ? true : _props$searchable,\n      controlledOpen = props.open,\n      placeholder = props.placeholder,\n      groupBy = props.groupBy,\n      menuClassName = props.menuClassName,\n      menuStyle = props.menuStyle,\n      _props$menuAutoWidth = props.menuAutoWidth,\n      menuAutoWidth = _props$menuAutoWidth === void 0 ? true : _props$menuAutoWidth,\n      _props$menuMaxHeight = props.menuMaxHeight,\n      menuMaxHeight = _props$menuMaxHeight === void 0 ? 320 : _props$menuMaxHeight,\n      creatable = props.creatable,\n      shouldDisplayCreateOption = props.shouldDisplayCreateOption,\n      valueProp = props.value,\n      _props$valueKey = props.valueKey,\n      valueKey = _props$valueKey === void 0 ? 'value' : _props$valueKey,\n      virtualized = props.virtualized,\n      _props$labelKey = props.labelKey,\n      labelKey = _props$labelKey === void 0 ? 'label' : _props$labelKey,\n      listProps = props.listProps,\n      id = props.id,\n      tabIndex = props.tabIndex,\n      sort = props.sort,\n      renderMenu = props.renderMenu,\n      renderExtraFooter = props.renderExtraFooter,\n      renderValue = props.renderValue,\n      renderMenuItem = props.renderMenuItem,\n      renderMenuGroup = props.renderMenuGroup,\n      onEnter = props.onEnter,\n      onEntered = props.onEntered,\n      onExit = props.onExit,\n      onExited = props.onExited,\n      onChange = props.onChange,\n      onClean = props.onClean,\n      onCreate = props.onCreate,\n      onSearch = props.onSearch,\n      onSelect = props.onSelect,\n      onOpen = props.onOpen,\n      onClose = props.onClose,\n      onBlur = props.onBlur,\n      onFocus = props.onFocus,\n      searchBy = props.searchBy,\n      _props$placement = props.placement,\n      placement = _props$placement === void 0 ? 'bottomStart' : _props$placement,\n      rest = _objectWithoutPropertiesLoose(props, [\"as\", \"appearance\", \"cleanable\", \"cacheData\", \"classPrefix\", \"data\", \"disabled\", \"readOnly\", \"plaintext\", \"defaultValue\", \"defaultOpen\", \"disabledItemValues\", \"locale\", \"toggleAs\", \"style\", \"searchable\", \"open\", \"placeholder\", \"groupBy\", \"menuClassName\", \"menuStyle\", \"menuAutoWidth\", \"menuMaxHeight\", \"creatable\", \"shouldDisplayCreateOption\", \"value\", \"valueKey\", \"virtualized\", \"labelKey\", \"listProps\", \"id\", \"tabIndex\", \"sort\", \"renderMenu\", \"renderExtraFooter\", \"renderValue\", \"renderMenuItem\", \"renderMenuGroup\", \"onEnter\", \"onEntered\", \"onExit\", \"onExited\", \"onChange\", \"onClean\", \"onCreate\", \"onSearch\", \"onSelect\", \"onOpen\", \"onClose\", \"onBlur\", \"onFocus\", \"searchBy\", \"placement\"]);\n\n  var _useContext = useContext(InputPickerContext),\n      multi = _useContext.multi,\n      tagProps = _useContext.tagProps,\n      trigger = _useContext.trigger,\n      disabledOptions = _useContext.disabledOptions;\n\n  if (groupBy === valueKey || groupBy === labelKey) {\n    throw Error('`groupBy` can not be equal to `valueKey` and `labelKey`');\n  }\n\n  var overlayRef = useRef(null);\n  var targetRef = useRef(null);\n  var triggerRef = useRef(null);\n  var inputRef = useRef();\n  var listRef = useRef(null);\n\n  var _useCustom = useCustom(['Picker', 'InputPicker'], overrideLocale),\n      locale = _useCustom.locale;\n\n  var _useClassNames = useClassNames(classPrefix),\n      prefix = _useClassNames.prefix,\n      merge = _useClassNames.merge;\n\n  var _useState = useState(controlledData),\n      uncontrolledData = _useState[0],\n      setData = _useState[1];\n\n  var _useState2 = useState(100),\n      maxWidth = _useState2[0],\n      setMaxWidth = _useState2[1];\n\n  var _useState3 = useState([]),\n      newData = _useState3[0],\n      setNewData = _useState3[1];\n\n  var _useState4 = useState(defaultOpen),\n      uncontrolledOpen = _useState4[0],\n      setOpen = _useState4[1];\n\n  var open = isUndefined(controlledOpen) ? uncontrolledOpen : controlledOpen;\n  var getAllData = useCallback(function () {\n    return [].concat(uncontrolledData, newData);\n  }, [uncontrolledData, newData]);\n  var getAllDataAndCache = useCallback(function () {\n    return [].concat(getAllData(), cacheData);\n  }, [getAllData, cacheData]);\n\n  var _useControlled = useControlled(valueProp, multi ? defaultValue || [] : defaultValue),\n      value = _useControlled[0],\n      setValue = _useControlled[1],\n      isControlled = _useControlled[2];\n\n  var cloneValue = useCallback(function () {\n    return multi ? clone(value) || [] : value;\n  }, [multi, value]);\n  var handleClose = useCallback(function () {\n    var _triggerRef$current;\n\n    triggerRef === null || triggerRef === void 0 ? void 0 : (_triggerRef$current = triggerRef.current) === null || _triggerRef$current === void 0 ? void 0 : _triggerRef$current.close();\n  }, [triggerRef]); // Used to hover the focuse item  when trigger `onKeydown`\n\n  var _useFocusItemValue = useFocusItemValue(multi ? value === null || value === void 0 ? void 0 : value[0] : value, {\n    data: getAllDataAndCache(),\n    valueKey: valueKey,\n    target: function target() {\n      return overlayRef.current;\n    }\n  }),\n      focusItemValue = _useFocusItemValue.focusItemValue,\n      setFocusItemValue = _useFocusItemValue.setFocusItemValue,\n      onKeyDown = _useFocusItemValue.onKeyDown;\n\n  var handleSearchCallback = useCallback(function (searchKeyword, filteredData, event) {\n    var _filteredData$;\n\n    // The first option after filtering is the focus.\n    setFocusItemValue(disabledOptions ? searchKeyword : (filteredData === null || filteredData === void 0 ? void 0 : (_filteredData$ = filteredData[0]) === null || _filteredData$ === void 0 ? void 0 : _filteredData$[valueKey]) || searchKeyword);\n    onSearch === null || onSearch === void 0 ? void 0 : onSearch(searchKeyword, event);\n  }, [disabledOptions, setFocusItemValue, valueKey, onSearch]); // Use search keywords to filter options.\n\n  var _useSearch = useSearch(getAllData(), {\n    labelKey: labelKey,\n    searchBy: searchBy,\n    callback: handleSearchCallback\n  }),\n      searchKeyword = _useSearch.searchKeyword,\n      resetSearch = _useSearch.resetSearch,\n      checkShouldDisplay = _useSearch.checkShouldDisplay,\n      handleSearch = _useSearch.handleSearch; // Update the state when the data in props changes\n\n\n  useEffect(function () {\n    if (controlledData && !shallowEqual(controlledData, uncontrolledData)) {\n      var _controlledData$;\n\n      setData(controlledData);\n      setNewData([]);\n      setFocusItemValue(controlledData === null || controlledData === void 0 ? void 0 : (_controlledData$ = controlledData[0]) === null || _controlledData$ === void 0 ? void 0 : _controlledData$[valueKey]);\n    }\n  }, [setFocusItemValue, controlledData, uncontrolledData, valueKey]);\n  useEffect(function () {\n    var _triggerRef$current2;\n\n    // In multiple selection, you need to set a maximum width for the input.\n    if ((_triggerRef$current2 = triggerRef.current) !== null && _triggerRef$current2 !== void 0 && _triggerRef$current2.root) {\n      setMaxWidth(getWidth(triggerRef.current.root));\n    }\n  }, []); // Update the position of the menu when the search keyword and value change\n\n  useEffect(function () {\n    var _triggerRef$current3, _triggerRef$current3$;\n\n    (_triggerRef$current3 = triggerRef.current) === null || _triggerRef$current3 === void 0 ? void 0 : (_triggerRef$current3$ = _triggerRef$current3.updatePosition) === null || _triggerRef$current3$ === void 0 ? void 0 : _triggerRef$current3$.call(_triggerRef$current3);\n  }, [searchKeyword, value]);\n\n  var getDateItem = function getDateItem(value) {\n    // Find active `MenuItem` by `value`\n    var allData = getAllDataAndCache();\n    var activeItem = allData.find(function (item) {\n      return shallowEqual(item[valueKey], value);\n    });\n    var itemNode = placeholder;\n\n    if (activeItem !== null && activeItem !== void 0 && activeItem[labelKey]) {\n      itemNode = activeItem === null || activeItem === void 0 ? void 0 : activeItem[labelKey];\n    }\n\n    return {\n      isValid: !!activeItem,\n      activeItem: activeItem,\n      itemNode: itemNode\n    };\n  };\n\n  var getInput = useCallback(function () {\n    var _inputRef$current;\n\n    return multi ? (_inputRef$current = inputRef.current) === null || _inputRef$current === void 0 ? void 0 : _inputRef$current.input : inputRef.current;\n  }, [inputRef, multi]);\n  var focusInput = useCallback(function () {\n    var _getInput;\n\n    return (_getInput = getInput()) === null || _getInput === void 0 ? void 0 : _getInput.focus();\n  }, [getInput]);\n  var blurInput = useCallback(function () {\n    var _getInput2;\n\n    return (_getInput2 = getInput()) === null || _getInput2 === void 0 ? void 0 : _getInput2.blur();\n  }, [getInput]);\n  /**\n   * Convert the string of the newly created option into an object.\n   */\n\n  var createOption = useCallback(function (value) {\n    var _ref2;\n\n    if (groupBy) {\n      var _ref;\n\n      return _ref = {\n        create: true\n      }, _ref[groupBy] = locale === null || locale === void 0 ? void 0 : locale.newItem, _ref[valueKey] = value, _ref[labelKey] = value, _ref;\n    }\n\n    return _ref2 = {\n      create: true\n    }, _ref2[valueKey] = value, _ref2[labelKey] = value, _ref2;\n  }, [groupBy, valueKey, labelKey, locale]);\n  var handleChange = useCallback(function (value, event) {\n    onChange === null || onChange === void 0 ? void 0 : onChange(value, event);\n  }, [onChange]);\n  var handleRemoveItemByTag = useCallback(function (tag, event) {\n    event.stopPropagation();\n    var val = cloneValue();\n    remove(val, function (itemVal) {\n      return shallowEqual(itemVal, tag);\n    });\n    setValue(val);\n    handleChange(val, event);\n  }, [setValue, cloneValue, handleChange]);\n  var handleSelect = useCallback(function (value, item, event) {\n    onSelect === null || onSelect === void 0 ? void 0 : onSelect(value, item, event);\n\n    if (creatable && item.create) {\n      delete item.create;\n      onCreate === null || onCreate === void 0 ? void 0 : onCreate(value, item, event);\n      setNewData(newData.concat(item));\n    }\n  }, [creatable, newData, onSelect, onCreate]);\n  /**\n   * Callback triggered by single selection\n   * @param value\n   * @param item\n   * @param event\n   */\n\n  var handleSelectItem = function handleSelectItem(value, item, event) {\n    setValue(value);\n    setFocusItemValue(value);\n    resetSearch();\n    handleSelect(value, item, event);\n    handleChange(value, event);\n    handleClose();\n  };\n  /**\n   * Callback triggered by multiple selection\n   * @param nextItemValue\n   * @param item\n   * @param event\n   * @param checked\n   */\n\n\n  var handleCheckTag = function handleCheckTag(nextItemValue, item, event, checked) {\n    var val = cloneValue();\n\n    if (checked) {\n      val.push(nextItemValue);\n    } else {\n      remove(val, function (itemVal) {\n        return shallowEqual(itemVal, nextItemValue);\n      });\n    }\n\n    setValue(val);\n    resetSearch();\n    setFocusItemValue(nextItemValue);\n    handleSelect(val, item, event);\n    handleChange(val, event);\n    focusInput();\n  };\n\n  var handleTagKeyPress = useCallback(function (event) {\n    // When composing, ignore the keypress event.\n    if (event.nativeEvent.isComposing) {\n      return;\n    }\n\n    var val = cloneValue();\n    var data = getAllData();\n\n    if (!focusItemValue || !data) {\n      return;\n    } // If the value is disabled in this option, it is returned.\n\n\n    if (disabledItemValues !== null && disabledItemValues !== void 0 && disabledItemValues.some(function (item) {\n      return item === focusItemValue;\n    })) {\n      return;\n    }\n\n    if (!val.some(function (v) {\n      return shallowEqual(v, focusItemValue);\n    })) {\n      val.push(focusItemValue);\n    } else if (!disabledOptions) {\n      remove(val, function (itemVal) {\n        return shallowEqual(itemVal, focusItemValue);\n      });\n    }\n\n    var focusItem = data.find(function (item) {\n      return shallowEqual(item === null || item === void 0 ? void 0 : item[valueKey], focusItemValue);\n    });\n\n    if (!focusItem) {\n      focusItem = createOption(focusItemValue);\n    }\n\n    setValue(val);\n    resetSearch();\n    handleSelect(val, focusItem, event);\n    handleChange(val, event);\n  }, [cloneValue, getAllData, focusItemValue, disabledItemValues, disabledOptions, setValue, resetSearch, handleSelect, handleChange, valueKey, createOption]);\n  var handleMenuItemKeyPress = useCallback(function (event) {\n    if (!focusItemValue || !controlledData) {\n      return;\n    } // If the value is disabled in this option, it is returned.\n\n\n    if (disabledItemValues !== null && disabledItemValues !== void 0 && disabledItemValues.some(function (item) {\n      return item === focusItemValue;\n    })) {\n      return;\n    } // Find active `MenuItem` by `value`\n\n\n    var allData = getAllData();\n    var focusItem = allData.find(function (item) {\n      return shallowEqual(item[valueKey], focusItemValue);\n    }); // FIXME Bad state flow\n\n    if (!focusItem && focusItemValue === searchKeyword) {\n      focusItem = createOption(searchKeyword);\n    }\n\n    setValue(focusItemValue);\n    resetSearch();\n\n    if (focusItem) {\n      handleSelect(focusItemValue, focusItem, event);\n    }\n\n    handleChange(focusItemValue, event);\n    handleClose();\n  }, [setValue, disabledItemValues, controlledData, focusItemValue, valueKey, searchKeyword, handleClose, resetSearch, createOption, getAllData, handleChange, handleSelect]);\n  usePublicMethods(ref, {\n    triggerRef: triggerRef,\n    overlayRef: overlayRef,\n    targetRef: targetRef,\n    listRef: listRef\n  });\n  /**\n   * Remove the last item, after pressing the back key on the keyboard.\n   * @param event\n   */\n\n  var removeLastItem = useCallback(function (event) {\n    var target = event === null || event === void 0 ? void 0 : event.target;\n\n    if ((target === null || target === void 0 ? void 0 : target.tagName) !== 'INPUT') {\n      focusInput();\n      return;\n    }\n\n    if ((target === null || target === void 0 ? void 0 : target.tagName) === 'INPUT' && target !== null && target !== void 0 && target.value) {\n      return;\n    }\n\n    var val = cloneValue();\n    val.pop();\n    setValue(val);\n    handleChange(val, event);\n  }, [setValue, focusInput, handleChange, cloneValue]);\n  var handleClean = useCallback(function (event) {\n    if (disabled || searchKeyword !== '') {\n      return;\n    }\n\n    setValue(null);\n    setFocusItemValue(null);\n    resetSearch();\n\n    if (multi) {\n      handleChange([], event);\n    } else {\n      handleChange(null, event);\n    }\n\n    onClean === null || onClean === void 0 ? void 0 : onClean(event);\n  }, [disabled, searchKeyword, setValue, setFocusItemValue, resetSearch, multi, onClean, handleChange]);\n  var events = {\n    onMenuPressBackspace: multi ? removeLastItem : handleClean,\n    onMenuKeyDown: onKeyDown,\n    onMenuPressEnter: undefined,\n    onKeyDown: undefined\n  };\n  var handleKeyPress = useCallback(function (event) {\n    // When typing a space, create a tag.\n    if (isOneOf('Space', trigger) && event.key === KEY_VALUES.SPACE) {\n      handleTagKeyPress(event);\n      event.preventDefault();\n    } // When typing a comma, create a tag.\n\n\n    if (isOneOf('Comma', trigger) && event.key === KEY_VALUES.COMMA) {\n      handleTagKeyPress(event);\n      event.preventDefault();\n    }\n  }, [handleTagKeyPress, trigger]);\n\n  if (multi) {\n    if (isOneOf('Enter', trigger)) {\n      events.onMenuPressEnter = handleTagKeyPress;\n    }\n\n    if (creatable) {\n      events.onKeyDown = handleKeyPress;\n    }\n  } else {\n    events.onMenuPressEnter = handleMenuItemKeyPress;\n  }\n\n  var onPickerKeyDown = useToggleKeyDownEvent(_extends({\n    triggerRef: triggerRef,\n    targetRef: targetRef,\n    overlayRef: overlayRef\n  }, events, rest));\n  var handleExited = useCallback(function () {\n    setFocusItemValue(multi ? value === null || value === void 0 ? void 0 : value[0] : value);\n    resetSearch();\n    onClose === null || onClose === void 0 ? void 0 : onClose();\n  }, [setFocusItemValue, resetSearch, onClose, value, multi]);\n  var handleFocus = useCallback(function () {\n    if (!readOnly) {\n      var _triggerRef$current4;\n\n      setOpen(true);\n      (_triggerRef$current4 = triggerRef.current) === null || _triggerRef$current4 === void 0 ? void 0 : _triggerRef$current4.open();\n    }\n  }, [readOnly]);\n  var handleBlur = useCallback(function () {\n    setOpen(false);\n  }, []);\n  var handleEnter = useCallback(function () {\n    focusInput();\n    setOpen(true);\n  }, [focusInput]);\n  var handleExit = useCallback(function () {\n    blurInput();\n    setOpen(false);\n  }, [blurInput]);\n\n  var renderDropdownMenuItem = function renderDropdownMenuItem(label, item) {\n    // 'Create option \"{0}\"' =>  Create option \"xxxxx\"\n    var newLabel = item.create ? /*#__PURE__*/React.createElement(\"span\", null, tplTransform(locale.createOption, label)) : label;\n    return renderMenuItem ? renderMenuItem(newLabel, item) : newLabel;\n  };\n\n  var checkValue = function checkValue() {\n    if (multi) {\n      return {\n        isValid: false,\n        itemNode: null\n      };\n    }\n\n    var dataItem = getDateItem(value);\n    var itemNode = dataItem.itemNode;\n\n    if (!isNil(value) && isFunction(renderValue)) {\n      itemNode = renderValue(value, dataItem.activeItem, itemNode);\n    }\n\n    return {\n      isValid: dataItem.isValid,\n      itemNode: itemNode\n    };\n  };\n\n  var renderMultiValue = function renderMultiValue() {\n    if (!multi) {\n      return null;\n    }\n\n    var _tagProps$closable = tagProps.closable,\n        closable = _tagProps$closable === void 0 ? true : _tagProps$closable,\n        onClose = tagProps.onClose,\n        tagRest = _objectWithoutPropertiesLoose(tagProps, [\"closable\", \"onClose\"]);\n\n    var tags = value || [];\n    var items = [];\n    var tagElements = tags.map(function (tag) {\n      var _getDateItem = getDateItem(tag),\n          isValid = _getDateItem.isValid,\n          itemNode = _getDateItem.itemNode,\n          activeItem = _getDateItem.activeItem;\n\n      items.push(activeItem);\n\n      if (!isValid) {\n        return null;\n      }\n\n      return /*#__PURE__*/React.createElement(Tag, _extends({}, tagRest, {\n        key: tag,\n        size: rest.size === 'lg' ? 'lg' : rest.size === 'xs' ? 'sm' : 'md',\n        closable: !disabled && closable && !readOnly && !plaintext,\n        title: typeof itemNode === 'string' ? itemNode : undefined,\n        onClose: createChainedFunction(handleRemoveItemByTag.bind(null, tag), onClose)\n      }), itemNode);\n    }).filter(function (item) {\n      return item !== null;\n    });\n\n    if ((tags.length > 0 || isControlled) && isFunction(renderValue)) {\n      return renderValue(value, items, tagElements);\n    }\n\n    return tagElements;\n  };\n\n  var renderDropdownMenu = function renderDropdownMenu(positionProps, speakerRef) {\n    var left = positionProps.left,\n        top = positionProps.top,\n        className = positionProps.className;\n    var menuClassPrefix = multi ? 'picker-check-menu' : 'picker-select-menu';\n    var classes = merge(className, menuClassName, prefix(multi ? 'check-menu' : 'select-menu'));\n\n    var styles = _extends({}, menuStyle, {\n      left: left,\n      top: top\n    });\n\n    var items = filterNodesOfTree(getAllData(), checkShouldDisplay);\n\n    if (creatable && (typeof shouldDisplayCreateOption === 'function' ? shouldDisplayCreateOption(searchKeyword, items) : searchKeyword && !items.find(function (item) {\n      return item[valueKey] === searchKeyword;\n    }))) {\n      items = [].concat(items, [createOption(searchKeyword)]);\n    } // Create a tree structure data when set `groupBy`\n\n\n    if (groupBy) {\n      items = getDataGroupBy(items, groupBy, sort);\n    } else if (typeof sort === 'function') {\n      items = items.sort(sort(false));\n    }\n\n    if (disabledOptions) {\n      return /*#__PURE__*/React.createElement(PickerOverlay, {\n        ref: mergeRefs(overlayRef, speakerRef)\n      });\n    }\n\n    var menu = items.length ? /*#__PURE__*/React.createElement(DropdownMenu, {\n      id: id ? id + \"-listbox\" : undefined,\n      listProps: listProps,\n      listRef: listRef,\n      disabledItemValues: disabledItemValues,\n      valueKey: valueKey,\n      labelKey: labelKey,\n      classPrefix: menuClassPrefix,\n      dropdownMenuItemClassPrefix: multi ? undefined : menuClassPrefix + \"-item\",\n      dropdownMenuItemAs: multi ? DropdownMenuCheckItem : DropdownMenuItem,\n      activeItemValues: multi ? value : [value],\n      focusItemValue: focusItemValue,\n      maxHeight: menuMaxHeight,\n      data: items // FIXME-Doma\n      // `group` is redundant so long as `groupBy` exists\n      ,\n      group: !isUndefined(groupBy),\n      groupBy: groupBy,\n      onSelect: multi ? handleCheckTag : handleSelectItem // fixme don't use any\n      ,\n      renderMenuGroup: renderMenuGroup,\n      renderMenuItem: renderDropdownMenuItem,\n      virtualized: virtualized\n    }) : /*#__PURE__*/React.createElement(\"div\", {\n      className: prefix(_templateObject || (_templateObject = _taggedTemplateLiteralLoose([\"none\"])))\n    }, locale === null || locale === void 0 ? void 0 : locale.noResultsText);\n    return /*#__PURE__*/React.createElement(PickerOverlay, {\n      ref: mergeRefs(overlayRef, speakerRef),\n      autoWidth: menuAutoWidth,\n      className: classes,\n      style: styles,\n      target: triggerRef,\n      onKeyDown: onPickerKeyDown\n    }, renderMenu ? renderMenu(menu) : menu, renderExtraFooter === null || renderExtraFooter === void 0 ? void 0 : renderExtraFooter());\n  };\n\n  var _checkValue = checkValue(),\n      isValid = _checkValue.isValid,\n      itemNode = _checkValue.itemNode;\n\n  var tagElements = renderMultiValue();\n  /**\n   * 1.Have a value and the value is valid.\n   * 2.Regardless of whether the value is valid, as long as renderValue is set, it is judged to have a value.\n   * 3.If renderValue returns null or undefined, hasValue is false.\n   */\n\n  var hasSingleValue = !isNil(value) && isFunction(renderValue) && !isNil(itemNode);\n  var hasMultiValue = isArray(value) && value.length > 0 && isFunction(renderValue) && !isNil(tagElements);\n  var hasValue = multi ? !!(tagElements !== null && tagElements !== void 0 && tagElements.length) || hasMultiValue : isValid || hasSingleValue;\n\n  var _usePickerClassName = usePickerClassName(_extends({}, props, {\n    classPrefix: classPrefix,\n    appearance: appearance,\n    hasValue: hasValue,\n    name: 'input',\n    cleanable: cleanable\n  })),\n      pickerClasses = _usePickerClassName[0],\n      usedClassNamePropKeys = _usePickerClassName[1];\n\n  var classes = merge(pickerClasses, (_merge = {}, _merge[prefix(_templateObject2 || (_templateObject2 = _taggedTemplateLiteralLoose([\"tag\"])))] = multi, _merge[prefix(_templateObject3 || (_templateObject3 = _taggedTemplateLiteralLoose([\"focused\"])))] = open, _merge[prefix(_templateObject4 || (_templateObject4 = _taggedTemplateLiteralLoose([\"disabled-options\"])))] = disabledOptions, _merge));\n  var searching = !!searchKeyword && open;\n  var displaySearchInput = searchable && !disabled;\n  var inputProps = multi ? {\n    inputStyle: {\n      maxWidth: maxWidth - 63\n    },\n    as: InputAutosize\n  } : {\n    as: 'input'\n  };\n\n  if (plaintext) {\n    var plaintextProps = {}; // TagPicker has -6px margin-left on the plaintext wrapper\n    // for fixing margin-left on tags from 2nd line on\n\n    if (multi && hasValue) {\n      plaintextProps.style = {\n        marginLeft: -6\n      };\n    }\n\n    return /*#__PURE__*/React.createElement(Plaintext, _extends({\n      localeKey: \"notSelected\",\n      ref: targetRef\n    }, plaintextProps), itemNode || (tagElements !== null && tagElements !== void 0 && tagElements.length ? tagElements : null) || placeholder);\n  }\n\n  var placeholderNode = placeholder || (disabledOptions ? null : locale === null || locale === void 0 ? void 0 : locale.placeholder);\n  return /*#__PURE__*/React.createElement(PickerToggleTrigger, {\n    pickerProps: pick(props, pickTriggerPropKeys),\n    ref: triggerRef,\n    trigger: \"active\",\n    onEnter: createChainedFunction(handleEnter, onEnter),\n    onEntered: createChainedFunction(onEntered, onOpen),\n    onExit: createChainedFunction(handleExit, onExit),\n    onExited: createChainedFunction(handleExited, onExited),\n    speaker: renderDropdownMenu,\n    placement: placement\n  }, /*#__PURE__*/React.createElement(Component, {\n    className: classes,\n    style: style,\n    onClick: focusInput,\n    onKeyDown: onPickerKeyDown\n  }, /*#__PURE__*/React.createElement(PickerToggle, _extends({}, omit(rest, [].concat(omitTriggerPropKeys, usedClassNamePropKeys)), {\n    id: id,\n    appearance: appearance,\n    readOnly: readOnly,\n    plaintext: plaintext,\n    ref: targetRef,\n    as: toggleAs,\n    tabIndex: undefined,\n    onClean: handleClean,\n    cleanable: cleanable && !disabled,\n    hasValue: hasValue,\n    active: open,\n    disabled: disabled,\n    placement: placement,\n    inputValue: value,\n    caret: !disabledOptions\n  }), searching || multi && hasValue ? null : itemNode || placeholderNode), !(!multi && disabled) && /*#__PURE__*/React.createElement(\"div\", {\n    className: prefix(_templateObject5 || (_templateObject5 = _taggedTemplateLiteralLoose([\"tag-wrapper\"])))\n  }, tagElements, displaySearchInput && /*#__PURE__*/React.createElement(InputSearch, _extends({}, inputProps, {\n    tabIndex: tabIndex,\n    readOnly: readOnly,\n    onBlur: createChainedFunction(handleBlur, onBlur),\n    onFocus: createChainedFunction(handleFocus, onFocus),\n    inputRef: inputRef,\n    onChange: handleSearch,\n    value: open ? searchKeyword : ''\n  })))));\n});\nInputPicker.displayName = 'InputPicker';\nInputPicker.propTypes = _extends({}, listPickerPropTypes, {\n  locale: PropTypes.any,\n  appearance: PropTypes.oneOf(['default', 'subtle']),\n  cacheData: PropTypes.array,\n  menuAutoWidth: PropTypes.bool,\n  menuMaxHeight: PropTypes.number,\n  searchable: PropTypes.bool,\n  creatable: PropTypes.bool,\n  groupBy: PropTypes.any,\n  sort: PropTypes.func,\n  renderMenu: PropTypes.func,\n  renderMenuItem: PropTypes.func,\n  renderMenuGroup: PropTypes.func,\n  onCreate: PropTypes.func,\n  onSelect: PropTypes.func,\n  onGroupTitleClick: PropTypes.func,\n  onSearch: PropTypes.func,\n  virtualized: PropTypes.bool,\n  searchBy: PropTypes.func\n});\nexport default InputPicker;"]},"metadata":{},"sourceType":"module"}