{"ast":null,"code":"import { authApi } from \"../../api/socialMediaAPI\";\nconst initialState = {\n  isAuthorized: false,\n  data: {}\n};\nexport const authReducer = function () {\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialState;\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n\n  switch (action.type) {\n    case \"auth/me\":\n      return { ...state,\n        data: { ...state.data,\n          ...action.data\n        },\n        isAuthorized: true\n      };\n\n    case \"auth/login\":\n      {\n        return { ...state,\n          isAuthorized: action.isAuthorized\n        };\n      }\n\n    default:\n      return state;\n  }\n};\nexport const meAC = data => {\n  return {\n    type: \"auth/me\",\n    data\n  };\n};\nexport const loginAC = () => {\n  return {\n    type: \"auth/login\",\n    isAuthorized: true\n  };\n};\nexport const meTC = () => dispatch => {\n  authApi.me().then(res => {\n    if (res.data.resultCode === 0) {\n      dispatch(meAC(res.data.data));\n    } else {\n      console.log(res.data.messages);\n    }\n  }).catch(err => {\n    console.log(err.message);\n  });\n};\nexport const loginTC = data => dispatch => {\n  authApi.login(data).then(res => {\n    if (res.data.resultCode === 0) {\n      dispatch(loginAC());\n    } else {\n      console.log(res.data.messages);\n    }\n  });\n};","map":{"version":3,"sources":["/Users/danilnagovicyn/Desktop/reactprojects/Incubator/Samurai_way/samurai-way/src/store/reducers/authReducer.ts"],"names":["authApi","initialState","isAuthorized","data","authReducer","state","action","type","meAC","loginAC","meTC","dispatch","me","then","res","resultCode","console","log","messages","catch","err","message","loginTC","login"],"mappings":"AACA,SAEEA,OAFF,QAIO,0BAJP;AAWA,MAAMC,YAA2B,GAAG;AAClCC,EAAAA,YAAY,EAAE,KADoB;AAElCC,EAAAA,IAAI,EAAE;AAF4B,CAApC;AAKA,OAAO,MAAMC,WAAW,GAAG,YAA+C;AAAA,MAA9CC,KAA8C,uEAAtCJ,YAAsC;AAAA,MAAxBK,MAAwB;;AACxE,UAAQA,MAAM,CAACC,IAAf;AACE,SAAK,SAAL;AACE,aAAO,EACL,GAAGF,KADE;AAELF,QAAAA,IAAI,EAAE,EACJ,GAAGE,KAAK,CAACF,IADL;AAEJ,aAAGG,MAAM,CAACH;AAFN,SAFD;AAMLD,QAAAA,YAAY,EAAE;AANT,OAAP;;AAQF,SAAK,YAAL;AAAmB;AACjB,eAAO,EACL,GAAGG,KADE;AAELH,UAAAA,YAAY,EAAEI,MAAM,CAACJ;AAFhB,SAAP;AAID;;AAED;AACE,aAAOG,KAAP;AAlBJ;AAoBD,CArBM;AAuBP,OAAO,MAAMG,IAAI,GAAIL,IAAD,IAId;AACJ,SAAO;AAAEI,IAAAA,IAAI,EAAE,SAAR;AAAmBJ,IAAAA;AAAnB,GAAP;AACD,CANM;AAOP,OAAO,MAAMM,OAAO,GAAG,MAAM;AAC3B,SAAO;AAAEF,IAAAA,IAAI,EAAE,YAAR;AAAsBL,IAAAA,YAAY,EAAE;AAApC,GAAP;AACD,CAFM;AAIP,OAAO,MAAMQ,IAAI,GAAG,MAAOC,QAAD,IAAqC;AAC7DX,EAAAA,OAAO,CACJY,EADH,GAEGC,IAFH,CAESC,GAAD,IAAS;AACb,QAAIA,GAAG,CAACX,IAAJ,CAASY,UAAT,KAAwB,CAA5B,EAA+B;AAC7BJ,MAAAA,QAAQ,CAACH,IAAI,CAACM,GAAG,CAACX,IAAJ,CAASA,IAAV,CAAL,CAAR;AACD,KAFD,MAEO;AACLa,MAAAA,OAAO,CAACC,GAAR,CAAYH,GAAG,CAACX,IAAJ,CAASe,QAArB;AACD;AACF,GARH,EASGC,KATH,CASUC,GAAD,IAAS;AACdJ,IAAAA,OAAO,CAACC,GAAR,CAAaG,GAAD,CAA6BC,OAAzC;AACD,GAXH;AAYD,CAbM;AAeP,OAAO,MAAMC,OAAO,GAAInB,IAAD,IAA0BQ,QAAD,IAAwB;AACtEX,EAAAA,OAAO,CAACuB,KAAR,CAAcpB,IAAd,EAAoBU,IAApB,CAA0BC,GAAD,IAAS;AAChC,QAAIA,GAAG,CAACX,IAAJ,CAASY,UAAT,KAAwB,CAA5B,EAA+B;AAC7BJ,MAAAA,QAAQ,CAACF,OAAO,EAAR,CAAR;AACD,KAFD,MAGK;AACHO,MAAAA,OAAO,CAACC,GAAR,CAAYH,GAAG,CAACX,IAAJ,CAASe,QAArB;AAED;AACF,GARD;AASD,CAVM","sourcesContent":["import { Dispatch } from \"redux\";\nimport {\n  LoginDataType,\n  authApi,\n  socialMediaAPI,\n} from \"../../api/socialMediaAPI\";\nimport {\n  SetLoggedUserDataActionType,\n  getLoggedUserDataTC,\n  setLoggedUserDataAC,\n} from \"./appReducer\";\n\nconst initialState: authStateType = {\n  isAuthorized: false,\n  data: {},\n};\n\nexport const authReducer = (state = initialState, action: ActionsType) => {\n  switch (action.type) {\n    case \"auth/me\":\n      return {\n        ...state,\n        data: {\n          ...state.data,\n          ...action.data,\n        },\n        isAuthorized: true,\n      };\n    case \"auth/login\": {\n      return {\n        ...state,\n        isAuthorized: action.isAuthorized,\n      };\n    }\n\n    default:\n      return state;\n  }\n};\n\nexport const meAC = (data: {\n  userId: number;\n  email: string;\n  login: string;\n}) => {\n  return { type: \"auth/me\", data } as const;\n};\nexport const loginAC = () => {\n  return { type: \"auth/login\", isAuthorized: true } as const;\n};\n\nexport const meTC = () => (dispatch: Dispatch<ActionsType>) => {\n  authApi\n    .me()\n    .then((res) => {\n      if (res.data.resultCode === 0) {\n        dispatch(meAC(res.data.data));\n      } else {\n        console.log(res.data.messages);\n      }\n    })\n    .catch((err) => {\n      console.log((err as { message: string }).message);\n    });\n};\n\nexport const loginTC = (data: LoginDataType) => (dispatch: Dispatch) => {\n  authApi.login(data).then((res) => {\n    if (res.data.resultCode === 0) {\n      dispatch(loginAC());\n    }\n    else {\n      console.log(res.data.messages);\n      \n    }\n  });\n};\n\nexport type authStateType = {\n  isAuthorized: boolean;\n  data: {\n    id?: number;\n    email?: string;\n    login?: string;\n  };\n};\n\ntype MeActionType = ReturnType<typeof meAC>;\ntype LoginActionType = ReturnType<typeof loginAC>;\n\ntype ActionsType = MeActionType | LoginActionType;\n"]},"metadata":{},"sourceType":"module"}